// ==ClosureCompiler==
// @compilation_level SIMPLE_OPTIMIZATIONS

/**
 * @license jqGrid  4.4.0  - jQuery Grid
 * Copyright (c) 2008, Tony Tomov, tony@trirand.com
 * Dual licensed under the MIT and GPL licenses
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl-2.0.html
 * Date: 2012-06-14
 */
//jsHint options
/*global document, window, jQuery, DOMParser, ActiveXObject, $, alert */
"use strict";
;(function($){$.jgrid=$.jgrid||{};$.extend($.jgrid,{version:"4.4.0",htmlDecode:function(a){if(a&&(a=='&nbsp;'||a=='&#160;'||(a.length===1&&a.charCodeAt(0)===160))){return""}return!a?a:String(a).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&")},htmlEncode:function(a){return!a?a:String(a).replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},format:function(a){var b=$.makeArray(arguments).slice(1);if(a===undefined){a=""}return a.replace(/\{(\d+)\}/g,function(m,i){return b[i]})},getCellIndex:function(a){var c=$(a);if(c.is('tr')){return-1}c=(!c.is('td')&&!c.is('th')?c.closest("td,th"):c)[0];if($.browser.msie){return $.inArray(c,c.parentNode.cells)}return c.cellIndex},stripHtml:function(v){v=v+"";var a=/<("[^"]*"|'[^']*'|[^'">])*>/gi;if(v){v=v.replace(a,"");return(v&&v!=='&nbsp;'&&v!=='&#160;')?v.replace(/\"/g,"'"):""}else{return v}},stripPref:function(a,b){var c=$.type(a);if(c=="string"||c=="number"){a=String(a);b=a!==""?String(b).replace(String(a),""):b}return b},stringToDoc:function(a){var b;if(typeof a!=='string'){return a}try{var c=new DOMParser();b=c.parseFromString(a,"text/xml")}catch(e){b=new ActiveXObject("Microsoft.XMLDOM");b.async=false;b.loadXML(a)}return(b&&b.documentElement&&b.documentElement.tagName!='parsererror')?b:null},parse:function(a){var b=a;if(b.substr(0,9)=="while(1);"){b=b.substr(9)}if(b.substr(0,2)=="/*"){b=b.substr(2,b.length-4)}if(!b){b="{}"}return($.jgrid.useJSON===true&&typeof(JSON)==='object'&&typeof(JSON.parse)==='function')?JSON.parse(b):eval('('+b+')')},parseDate:function(b,c){var d={m:1,d:1,y:1970,h:0,i:0,s:0,u:0},k,hl,dM,regdate=/[\\\/:_;.,\t\T\s-]/;if(c&&c!==null&&c!==undefined){c=$.trim(c);c=c.split(regdate);if($.jgrid.formatter.date.masks[b]!==undefined){b=$.jgrid.formatter.date.masks[b]}b=b.split(regdate);var e=$.jgrid.formatter.date.monthNames;var f=$.jgrid.formatter.date.AmPm;var g=function(a,h){if(a===0){if(h===12){h=0}}else{if(h!==12){h+=12}}return h};for(k=0,hl=b.length;k<hl;k++){if(b[k]=='M'){dM=$.inArray(c[k],e);if(dM!==-1&&dM<12){c[k]=dM+1;d.m=c[k]}}if(b[k]=='F'){dM=$.inArray(c[k],e);if(dM!==-1&&dM>11){c[k]=dM+1-12;d.m=c[k]}}if(b[k]=='a'){dM=$.inArray(c[k],f);if(dM!==-1&&dM<2&&c[k]==f[dM]){c[k]=dM;d.h=g(c[k],d.h)}}if(b[k]=='A'){dM=$.inArray(c[k],f);if(dM!==-1&&dM>1&&c[k]==f[dM]){c[k]=dM-2;d.h=g(c[k],d.h)}}if(c[k]!==undefined){d[b[k].toLowerCase()]=parseInt(c[k],10)}}d.m=parseInt(d.m,10)-1;var i=d.y;if(i>=70&&i<=99){d.y=1900+d.y}else if(i>=0&&i<=69){d.y=2000+d.y}if(d.j!==undefined){d.d=d.j}if(d.n!==undefined){d.m=parseInt(d.n,10)-1}}return new Date(d.y,d.m,d.d,d.h,d.i,d.s,d.u)},jqID:function(a){return String(a).replace(/[!"#$%&'()*+,.\/:;<=>?@\[\\\]\^`{|}~]/g,"\\$&")},guid:1,uidPref:'jqg',randId:function(a){return(a?a:$.jgrid.uidPref)+($.jgrid.guid++)},getAccessor:function(a,b){var c,p,prm=[],i;if(typeof b==='function'){return b(a)}c=a[b];if(c===undefined){try{if(typeof b==='string'){prm=b.split('.')}i=prm.length;if(i){c=a;while(c&&i--){p=prm.shift();c=c[p]}}}catch(e){}}return c},getXmlData:function(a,b,c){var d,m=typeof(b)==='string'?b.match(/^(.*)\[(\w+)\]$/):null;if(typeof(b)==='function'){return b(a)}if(m&&m[2]){return m[1]?$(m[1],a).attr(m[2]):$(a).attr(m[2])}else{d=$(b,a);if(c){return d}return d.length>0?$(d).text():undefined}},cellWidth:function(){var a=$("<div class='ui-jqgrid' style='left:10000px'><table class='ui-jqgrid-btable' style='width:5px;'><tr class='jqgrow'><td style='width:5px;'></td></tr></table></div>"),testCell=a.appendTo("body").find("td").width();a.remove();return testCell!==5},ajaxOptions:{},from:function(m){var n=function(d,q){if(typeof(d)=="string"){d=$.data(d)}var l=this,_data=d,_usecase=true,_trim=false,_query=q,_stripNum=/[\$,%]/g,_lastCommand=null,_lastField=null,_orDepth=0,_negate=false,_queuedOperator="",_sorting=[],_useProperties=true;if(typeof(d)=="object"&&d.push){if(d.length>0){if(typeof(d[0])!="object"){_useProperties=false}else{_useProperties=true}}}else{throw"data provides is not an array";}this._hasData=function(){return _data===null?false:_data.length===0?false:true};this._getStr=function(s){var a=[];if(_trim){a.push("jQuery.trim(")}a.push("String("+s+")");if(_trim){a.push(")")}if(!_usecase){a.push(".toLowerCase()")}return a.join("")};this._strComp=function(a){if(typeof(a)=="string"){return".toString()"}else{return""}};this._group=function(f,u){return({field:f.toString(),unique:u,items:[]})};this._toStr=function(a){if(_trim){a=$.trim(a)}a=a.toString().replace(/\\/g,'\\\\').replace(/\"/g,'\\"');return _usecase?a:a.toLowerCase()};this._funcLoop=function(a){var b=[];$.each(_data,function(i,v){b.push(a(v))});return b};this._append=function(s){var i;if(_query===null){_query=""}else{_query+=_queuedOperator===""?" && ":_queuedOperator}for(i=0;i<_orDepth;i++){_query+="("}if(_negate){_query+="!"}_query+="("+s+")";_negate=false;_queuedOperator="";_orDepth=0};this._setCommand=function(f,c){_lastCommand=f;_lastField=c};this._resetNegate=function(){_negate=false};this._repeatCommand=function(f,v){if(_lastCommand===null){return l}if(f!==null&&v!==null){return _lastCommand(f,v)}if(_lastField===null){return _lastCommand(f)}if(!_useProperties){return _lastCommand(f)}return _lastCommand(_lastField,f)};this._equals=function(a,b){return(l._compare(a,b,1)===0)};this._compare=function(a,b,d){var toString=Object.prototype.toString;if(d===undefined){d=1}if(a===undefined){a=null}if(b===undefined){b=null}if(a===null&&b===null){return 0}if(a===null&&b!==null){return 1}if(a!==null&&b===null){return-1}if(toString.call(a)==='[object Date]'&&toString.call(b)==='[object Date]'){if(a<b){return-d}if(a>b){return d}return 0}if(!_usecase&&typeof(a)!=="number"&&typeof(b)!=="number"){a=String(a).toLowerCase();b=String(b).toLowerCase()}if(a<b){return-d}if(a>b){return d}return 0};this._performSort=function(){if(_sorting.length===0){return}_data=l._doSort(_data,0)};this._doSort=function(d,q){var a=_sorting[q].by,dir=_sorting[q].dir,type=_sorting[q].type,dfmt=_sorting[q].datefmt;if(q==_sorting.length-1){return l._getOrder(d,a,dir,type,dfmt)}q++;var b=l._getGroup(d,a,dir,type,dfmt);var c=[];for(var i=0;i<b.length;i++){var e=l._doSort(b[i].items,q);for(var j=0;j<e.length;j++){c.push(e[j])}}return c};this._getOrder=function(c,d,e,f,g){var h=[],_sortData=[],newDir=e=="a"?1:-1,i,ab,j,findSortKey;if(f===undefined){f="text"}if(f=='float'||f=='number'||f=='currency'||f=='numeric'){findSortKey=function(a){var b=parseFloat(String(a).replace(_stripNum,''));return isNaN(b)?0.00:b}}else if(f=='int'||f=='integer'){findSortKey=function(a){return a?parseFloat(String(a).replace(_stripNum,'')):0}}else if(f=='date'||f=='datetime'){findSortKey=function(a){return $.jgrid.parseDate(g,a).getTime()}}else if($.isFunction(f)){findSortKey=f}else{findSortKey=function(a){if(!a){a=""}return $.trim(String(a).toUpperCase())}}$.each(c,function(i,v){ab=d!==""?$.jgrid.getAccessor(v,d):v;if(ab===undefined){ab=""}ab=findSortKey(ab,v);_sortData.push({'vSort':ab,'index':i})});_sortData.sort(function(a,b){a=a.vSort;b=b.vSort;return l._compare(a,b,newDir)});j=0;var k=c.length;while(j<k){i=_sortData[j].index;h.push(c[i]);j++}return h};this._getGroup=function(a,b,c,d,e){var f=[],group=null,last=null,val;$.each(l._getOrder(a,b,c,d,e),function(i,v){val=$.jgrid.getAccessor(v,b);if(val===undefined){val=""}if(!l._equals(last,val)){last=val;if(group!==null){f.push(group)}group=l._group(b,val)}group.items.push(v)});if(group!==null){f.push(group)}return f};this.ignoreCase=function(){_usecase=false;return l};this.useCase=function(){_usecase=true;return l};this.trim=function(){_trim=true;return l};this.noTrim=function(){_trim=false;return l};this.execute=function(){var a=_query,results=[];if(a===null){return l}$.each(_data,function(){if(eval(a)){results.push(this)}});_data=results;return l};this.data=function(){return _data};this.select=function(f){l._performSort();if(!l._hasData()){return[]}l.execute();if($.isFunction(f)){var a=[];$.each(_data,function(i,v){a.push(f(v))});return a}return _data};this.hasMatch=function(){if(!l._hasData()){return false}l.execute();return _data.length>0};this.andNot=function(f,v,x){_negate=!_negate;return l.and(f,v,x)};this.orNot=function(f,v,x){_negate=!_negate;return l.or(f,v,x)};this.not=function(f,v,x){return l.andNot(f,v,x)};this.and=function(f,v,x){_queuedOperator=" && ";if(f===undefined){return l}return l._repeatCommand(f,v,x)};this.or=function(f,v,x){_queuedOperator=" || ";if(f===undefined){return l}return l._repeatCommand(f,v,x)};this.orBegin=function(){_orDepth++;return l};this.orEnd=function(){if(_query!==null){_query+=")"}return l};this.isNot=function(f){_negate=!_negate;return l.is(f)};this.is=function(f){l._append('this.'+f);l._resetNegate();return l};this._compareValues=function(a,f,v,b,t){var c;if(_useProperties){c='jQuery.jgrid.getAccessor(this,\''+f+'\')'}else{c='this'}if(v===undefined){v=null}var d=v,swst=t.stype===undefined?"text":t.stype;if(v!==null){switch(swst){case'int':case'integer':d=(isNaN(Number(d))||d==="")?'0':d;c='parseInt('+c+',10)';d='parseInt('+d+',10)';break;case'float':case'number':case'numeric':d=String(d).replace(_stripNum,'');d=(isNaN(Number(d))||d==="")?'0':d;c='parseFloat('+c+')';d='parseFloat('+d+')';break;case'date':case'datetime':d=String($.jgrid.parseDate(t.newfmt||'Y-m-d',d).getTime());c='jQuery.jgrid.parseDate("'+t.srcfmt+'",'+c+').getTime()';break;default:c=l._getStr(c);d=l._getStr('"'+l._toStr(d)+'"')}}l._append(c+' '+b+' '+d);l._setCommand(a,f);l._resetNegate();return l};this.equals=function(f,v,t){return l._compareValues(l.equals,f,v,"==",t)};this.notEquals=function(f,v,t){return l._compareValues(l.equals,f,v,"!==",t)};this.isNull=function(f,v,t){return l._compareValues(l.equals,f,null,"===",t)};this.greater=function(f,v,t){return l._compareValues(l.greater,f,v,">",t)};this.less=function(f,v,t){return l._compareValues(l.less,f,v,"<",t)};this.greaterOrEquals=function(f,v,t){return l._compareValues(l.greaterOrEquals,f,v,">=",t)};this.lessOrEquals=function(f,v,t){return l._compareValues(l.lessOrEquals,f,v,"<=",t)};this.startsWith=function(f,v){var a=(v===undefined||v===null)?f:v,length=_trim?$.trim(a.toString()).length:a.toString().length;if(_useProperties){l._append(l._getStr('jQuery.jgrid.getAccessor(this,\''+f+'\')')+'.substr(0,'+length+') == '+l._getStr('"'+l._toStr(v)+'"'))}else{length=_trim?$.trim(v.toString()).length:v.toString().length;l._append(l._getStr('this')+'.substr(0,'+length+') == '+l._getStr('"'+l._toStr(f)+'"'))}l._setCommand(l.startsWith,f);l._resetNegate();return l};this.endsWith=function(f,v){var a=(v===undefined||v===null)?f:v,length=_trim?$.trim(a.toString()).length:a.toString().length;if(_useProperties){l._append(l._getStr('jQuery.jgrid.getAccessor(this,\''+f+'\')')+'.substr('+l._getStr('jQuery.jgrid.getAccessor(this,\''+f+'\')')+'.length-'+length+','+length+') == "'+l._toStr(v)+'"')}else{l._append(l._getStr('this')+'.substr('+l._getStr('this')+'.length-"'+l._toStr(f)+'".length,"'+l._toStr(f)+'".length) == "'+l._toStr(f)+'"')}l._setCommand(l.endsWith,f);l._resetNegate();return l};this.contains=function(f,v){if(_useProperties){l._append(l._getStr('jQuery.jgrid.getAccessor(this,\''+f+'\')')+'.indexOf("'+l._toStr(v)+'",0) > -1')}else{l._append(l._getStr('this')+'.indexOf("'+l._toStr(f)+'",0) > -1')}l._setCommand(l.contains,f);l._resetNegate();return l};this.groupBy=function(a,b,c,d){if(!l._hasData()){return null}return l._getGroup(_data,a,b,c,d)};this.orderBy=function(a,b,c,d){b=b===undefined||b===null?"a":$.trim(b.toString().toLowerCase());if(c===null||c===undefined){c="text"}if(d===null||d===undefined){d="Y-m-d"}if(b=="desc"||b=="descending"){b="d"}if(b=="asc"||b=="ascending"){b="a"}_sorting.push({by:a,dir:b,type:c,datefmt:d});return l};return l};return new n(m,null)},extend:function(a){$.extend($.fn.jqGrid,a);if(!this.no_legacy_api){$.fn.extend(a)}}});$.fn.jqGrid=function(N){if(typeof N=='string'){var O=$.jgrid.getAccessor($.fn.jqGrid,N);if(!O){throw("jqGrid - No such method: "+N);}var P=$.makeArray(arguments).slice(1);return O.apply(this,P)}return this.each(function(){if(this.grid){return}var p=$.extend(true,{url:"",height:150,page:1,rowNum:20,rowTotal:null,records:0,pager:"",pgbuttons:true,pginput:true,colModel:[],rowList:[],colNames:[],sortorder:"asc",sortname:"",datatype:"xml",mtype:"GET",altRows:false,selarrrow:[],savedRow:[],shrinkToFit:true,xmlReader:{},jsonReader:{},subGrid:false,subGridModel:[],reccount:0,lastpage:0,lastsort:0,selrow:null,beforeSelectRow:null,onSelectRow:null,onSortCol:null,ondblClickRow:null,onRightClickRow:null,onPaging:null,onSelectAll:null,loadComplete:null,gridComplete:null,loadError:null,loadBeforeSend:null,afterInsertRow:null,beforeRequest:null,beforeProcessing:null,onHeaderClick:null,viewrecords:false,loadonce:false,multiselect:false,multikey:false,editurl:null,search:false,caption:"",hidegrid:true,hiddengrid:false,postData:{},userData:{},treeGrid:false,treeGridModel:'nested',treeReader:{},treeANode:-1,ExpandColumn:null,tree_root_level:0,prmNames:{page:"page",rows:"rows",sort:"sidx",order:"sord",search:"_search",nd:"nd",id:"id",oper:"oper",editoper:"edit",addoper:"add",deloper:"del",subgridid:"id",npage:null,totalrows:"totalrows"},forceFit:false,gridstate:"visible",cellEdit:false,cellsubmit:"remote",nv:0,loadui:"enable",toolbar:[false,""],scroll:false,multiboxonly:false,deselectAfterSort:true,scrollrows:false,autowidth:false,scrollOffset:18,cellLayout:5,subGridWidth:20,multiselectWidth:20,gridview:false,rownumWidth:25,rownumbers:false,pagerpos:'center',recordpos:'right',footerrow:false,userDataOnFooter:false,hoverrows:true,altclass:'ui-priority-secondary',viewsortcols:[false,'vertical',true],resizeclass:'',autoencode:false,remapColumns:[],ajaxGridOptions:{},direction:"ltr",toppager:false,headertitles:false,scrollTimeout:40,data:[],_index:{},grouping:false,groupingView:{groupField:[],groupOrder:[],groupText:[],groupColumnShow:[],groupSummary:[],showSummaryOnHide:false,sortitems:[],sortnames:[],summary:[],summaryval:[],plusicon:'ui-icon-circlesmall-plus',minusicon:'ui-icon-circlesmall-minus'},ignoreCase:false,cmTemplate:{},idPrefix:""},$.jgrid.defaults,N||{});var u=this,grid={headers:[],cols:[],footers:[],dragStart:function(i,x,y){this.resizing={idx:i,startX:x.clientX,sOL:y[0]};this.hDiv.style.cursor="col-resize";this.curGbox=$("#rs_m"+$.jgrid.jqID(p.id),"#gbox_"+$.jgrid.jqID(p.id));this.curGbox.css({display:"block",left:y[0],top:y[1],height:y[2]});$(u).triggerHandler("jqGridResizeStart",[x,i]);if($.isFunction(p.resizeStart)){p.resizeStart.call(this,x,i)}document.onselectstart=function(){return false}},dragMove:function(x){if(this.resizing){var a=x.clientX-this.resizing.startX,h=this.headers[this.resizing.idx],newWidth=p.direction==="ltr"?h.width+a:h.width-a,hn,nWn;if(newWidth>33){this.curGbox.css({left:this.resizing.sOL+a});if(p.forceFit===true){hn=this.headers[this.resizing.idx+p.nv];nWn=p.direction==="ltr"?hn.width-a:hn.width+a;if(nWn>33){h.newWidth=newWidth;hn.newWidth=nWn}}else{this.newWidth=p.direction==="ltr"?p.tblwidth+a:p.tblwidth-a;h.newWidth=newWidth}}}},dragEnd:function(){this.hDiv.style.cursor="default";if(this.resizing){var a=this.resizing.idx,nw=this.headers[a].newWidth||this.headers[a].width;nw=parseInt(nw,10);this.resizing=false;$("#rs_m"+$.jgrid.jqID(p.id)).css("display","none");p.colModel[a].width=nw;this.headers[a].width=nw;this.headers[a].el.style.width=nw+"px";this.cols[a].style.width=nw+"px";if(this.footers.length>0){this.footers[a].style.width=nw+"px"}if(p.forceFit===true){nw=this.headers[a+p.nv].newWidth||this.headers[a+p.nv].width;this.headers[a+p.nv].width=nw;this.headers[a+p.nv].el.style.width=nw+"px";this.cols[a+p.nv].style.width=nw+"px";if(this.footers.length>0){this.footers[a+p.nv].style.width=nw+"px"}p.colModel[a+p.nv].width=nw}else{p.tblwidth=this.newWidth||p.tblwidth;$('table:first',this.bDiv).css("width",p.tblwidth+"px");$('table:first',this.hDiv).css("width",p.tblwidth+"px");this.hDiv.scrollLeft=this.bDiv.scrollLeft;if(p.footerrow){$('table:first',this.sDiv).css("width",p.tblwidth+"px");this.sDiv.scrollLeft=this.bDiv.scrollLeft}}$(u).triggerHandler("jqGridResizeStop",[nw,a]);if($.isFunction(p.resizeStop)){p.resizeStop.call(this,nw,a)}}this.curGbox=null;document.onselectstart=function(){return true}},populateVisible:function(){if(grid.timer){clearTimeout(grid.timer)}grid.timer=null;var a=$(grid.bDiv).height();if(!a){return}var b=$("table:first",grid.bDiv);var c,rh;if(b[0].rows.length){try{c=b[0].rows[1];rh=c?$(c).outerHeight()||grid.prevRowHeight:grid.prevRowHeight}catch(pv){rh=grid.prevRowHeight}}if(!rh){return}grid.prevRowHeight=rh;var d=p.rowNum;var e=grid.scrollTop=grid.bDiv.scrollTop;var f=Math.round(b.position().top)-e;var g=f+b.height();var h=rh*d;var i,npage,empty;if(g<a&&f<=0&&(p.lastpage===undefined||parseInt((g+e+h-1)/h,10)<=p.lastpage)){npage=parseInt((a-g+h-1)/h,10);if(g>=0||npage<2||p.scroll===true){i=Math.round((g+e)/h)+1;f=-1}else{f=1}}if(f>0){i=parseInt(e/h,10)+1;npage=parseInt((e+a)/h,10)+2-i;empty=true}if(npage){if(p.lastpage&&i>p.lastpage||p.lastpage==1||(i===p.page&&i===p.lastpage)){return}if(grid.hDiv.loading){grid.timer=setTimeout(grid.populateVisible,p.scrollTimeout)}else{p.page=i;if(empty){grid.selectionPreserver(b[0]);grid.emptyRows.call(b[0],false,false)}grid.populate(npage)}}},scrollGrid:function(e){if(p.scroll){var a=grid.bDiv.scrollTop;if(grid.scrollTop===undefined){grid.scrollTop=0}if(a!=grid.scrollTop){grid.scrollTop=a;if(grid.timer){clearTimeout(grid.timer)}grid.timer=setTimeout(grid.populateVisible,p.scrollTimeout)}}grid.hDiv.scrollLeft=grid.bDiv.scrollLeft;if(p.footerrow){grid.sDiv.scrollLeft=grid.bDiv.scrollLeft}if(e){e.stopPropagation()}},selectionPreserver:function(a){var p=a.p,sr=p.selrow,sra=p.selarrrow?$.makeArray(p.selarrrow):null,left=a.grid.bDiv.scrollLeft,restoreSelection=function(){var i;p.selrow=null;p.selarrrow=[];if(p.multiselect&&sra&&sra.length>0){for(i=0;i<sra.length;i++){if(sra[i]!=sr){$(a).jqGrid("setSelection",sra[i],false,null)}}}if(sr){$(a).jqGrid("setSelection",sr,false,null)}a.grid.bDiv.scrollLeft=left;$(a).unbind('.selectionPreserver',restoreSelection)};$(a).bind('jqGridGridComplete.selectionPreserver',restoreSelection)}};if(this.tagName.toUpperCase()!='TABLE'){alert("Element is not a table");return}if(document.documentMode!==undefined){if(document.documentMode<=5){alert("Grid can not be used in this ('quirks') mode!");return}}$(this).empty().attr("tabindex","1");this.p=p;this.p.useProp=!!$.fn.prop;var i,dir;if(this.p.colNames.length===0){for(i=0;i<this.p.colModel.length;i++){this.p.colNames[i]=this.p.colModel[i].label||this.p.colModel[i].name}}if(this.p.colNames.length!==this.p.colModel.length){alert($.jgrid.errors.model);return}var z=$("<div class='ui-jqgrid-view'></div>"),ii,isMSIE=$.browser.msie?true:false;u.p.direction=$.trim(u.p.direction.toLowerCase());if($.inArray(u.p.direction,["ltr","rtl"])==-1){u.p.direction="ltr"}dir=u.p.direction;$(z).insertBefore(this);$(this).appendTo(z).removeClass("scroll");var A=$("<div class='ui-jqgrid ui-widget ui-widget-content ui-corner-all'></div>");$(A).insertBefore(z).attr({"id":"gbox_"+this.id,"dir":dir});$(z).appendTo(A).attr("id","gview_"+this.id);if(isMSIE&&$.browser.version<=6){ii='<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>'}else{ii=""}$("<div class='ui-widget-overlay jqgrid-overlay' id='lui_"+this.id+"'></div>").append(ii).insertBefore(z);$("<div class='loading ui-state-default ui-state-active' id='load_"+this.id+"'>"+this.p.loadtext+"</div>").insertBefore(z);$(this).attr({cellspacing:"0",cellpadding:"0",border:"0","role":"grid","aria-multiselectable":!!this.p.multiselect,"aria-labelledby":"gbox_"+this.id});var B=["shiftKey","altKey","ctrlKey"],intNum=function(a,b){a=parseInt(a,10);if(isNaN(a)){return b?b:0}else{return a}},formatCol=function(a,b,c,d,e,f){var g=u.p.colModel[a],ral=g.align,result="style=\"",clas=g.classes,nm=g.name,celp,acp=[];if(ral){result+="text-align:"+ral+";"}if(g.hidden===true){result+="display:none;"}if(b===0){result+="width: "+grid.headers[a].width+"px;"}else if(g.cellattr&&$.isFunction(g.cellattr)){celp=g.cellattr.call(u,e,c,d,g,f);if(celp&&typeof(celp)==="string"){celp=celp.replace(/style/i,'style').replace(/title/i,'title');if(celp.indexOf('title')>-1){g.title=false}if(celp.indexOf('class')>-1){clas=undefined}acp=celp.split("style");if(acp.length===2){acp[1]=$.trim(acp[1].replace("=",""));if(acp[1].indexOf("'")===0||acp[1].indexOf('"')===0){acp[1]=acp[1].substring(1)}result+=acp[1].replace(/'/gi,'"')}else{result+="\""}}}if(!acp.length){acp[0]="";result+="\""}result+=(clas!==undefined?(" class=\""+clas+"\""):"")+((g.title&&c)?(" title=\""+$.jgrid.stripHtml(c)+"\""):"");result+=" aria-describedby=\""+u.p.id+"_"+nm+"\"";return result+acp[0]},cellVal=function(a){return a===undefined||a===null||a===""?"&#160;":(u.p.autoencode?$.jgrid.htmlEncode(a):a+"")},formatter=function(a,b,c,d,e){var f=u.p.colModel[c],v;if(typeof f.formatter!=='undefined'){var g={rowId:a,colModel:f,gid:u.p.id,pos:c};if($.isFunction(f.formatter)){v=f.formatter.call(u,b,g,d,e)}else if($.fmatter){v=$.fn.fmatter.call(u,f.formatter,b,g,d,e)}else{v=cellVal(b)}}else{v=cellVal(b)}return v},addCell=function(a,b,c,d,e){var v,prp;v=formatter(a,b,c,e,'add');prp=formatCol(c,d,v,e,a,true);return"<td role=\"gridcell\" "+prp+">"+v+"</td>"},addMulti=function(a,b,c){var v="<input role=\"checkbox\" type=\"checkbox\""+" id=\"jqg_"+u.p.id+"_"+a+"\" class=\"cbox\" name=\"jqg_"+u.p.id+"_"+a+"\"/>",prp=formatCol(b,c,'',null,a,true);return"<td role=\"gridcell\" "+prp+">"+v+"</td>"},addRowNum=function(a,b,c,d){var v=(parseInt(c,10)-1)*parseInt(d,10)+1+b,prp=formatCol(a,b,v,null,b,true);return"<td role=\"gridcell\" class=\"ui-state-default jqgrid-rownum\" "+prp+">"+v+"</td>"},reader=function(a){var b,f=[],j=0,i;for(i=0;i<u.p.colModel.length;i++){b=u.p.colModel[i];if(b.name!=='cb'&&b.name!=='subgrid'&&b.name!=='rn'){f[j]=a=="local"?b.name:((a=="xml"||a==="xmlstring")?b.xmlmap||b.name:b.jsonmap||b.name);j++}}return f},orderedCols=function(a){var b=u.p.remapColumns;if(!b||!b.length){b=$.map(u.p.colModel,function(v,i){return i})}if(a){b=$.map(b,function(v){return v<a?null:v-a})}return b},emptyRows=function(a,b){var c;if(this.p.deepempty){$(this.rows).slice(1).remove()}else{c=this.rows.length>0?this.rows[0]:null;$(this.firstChild).empty().append(c)}if(a&&this.p.scroll){$(this.grid.bDiv.firstChild).css({height:"auto"});$(this.grid.bDiv.firstChild.firstChild).css({height:0,display:"none"});if(this.grid.bDiv.scrollTop!==0){this.grid.bDiv.scrollTop=0}}if(b===true&&this.p.treeGrid){this.p.data=[];this.p._index={}}},refreshIndex=function(){var a=u.p.data.length,idname,i,val,ni=u.p.rownumbers===true?1:0,gi=u.p.multiselect===true?1:0,si=u.p.subGrid===true?1:0;if(u.p.keyIndex===false||u.p.loadonce===true){idname=u.p.localReader.id}else{idname=u.p.colModel[u.p.keyIndex+gi+si+ni].name}for(i=0;i<a;i++){val=$.jgrid.getAccessor(u.p.data[i],idname);u.p._index[val]=i}},constructTr=function(a,b,c,d,e){var f='-1',restAttr='',attrName,style=b?'display:none;':'',classes='ui-widget-content jqgrow ui-row-'+u.p.direction+c,rowAttrObj=$.isFunction(u.p.rowattr)?u.p.rowattr.call(u,d,e):{};if(!$.isEmptyObject(rowAttrObj)){if(rowAttrObj.hasOwnProperty("id")){a=rowAttrObj.id;delete rowAttrObj.id}if(rowAttrObj.hasOwnProperty("tabindex")){f=rowAttrObj.tabindex;delete rowAttrObj.tabindex}if(rowAttrObj.hasOwnProperty("style")){style+=rowAttrObj.style;delete rowAttrObj.style}if(rowAttrObj.hasOwnProperty("class")){classes+=' '+rowAttrObj['class'];delete rowAttrObj['class']}try{delete rowAttrObj.role}catch(ra){}for(attrName in rowAttrObj){if(rowAttrObj.hasOwnProperty(attrName)){restAttr+=' '+attrName+'='+rowAttrObj[attrName]}}}return'<tr role="row" id="'+a+'" tabindex="'+f+'" class="'+classes+'"'+(style===''?'':' style="'+style+'"')+restAttr+'>'},addXmlData=function(b,t,c,d,g){var h=new Date(),locdata=(u.p.datatype!="local"&&u.p.loadonce)||u.p.datatype=="xmlstring",xmlid="_id_",xmlRd=u.p.xmlReader,frd=u.p.datatype=="local"?"local":"xml";if(locdata){u.p.data=[];u.p._index={};u.p.localReader.id=xmlid}u.p.reccount=0;if($.isXMLDoc(b)){if(u.p.treeANode===-1&&!u.p.scroll){emptyRows.call(u,false,true);c=1}else{c=c>1?c:1}}else{return}var i,fpos,ir=0,v,gi=u.p.multiselect===true?1:0,si=u.p.subGrid===true?1:0,ni=u.p.rownumbers===true?1:0,idn,getId,f=[],F,rd={},xmlr,rid,rowData=[],cn=(u.p.altRows===true)?" "+u.p.altclass:"",cn1;if(!xmlRd.repeatitems){f=reader(frd)}if(u.p.keyIndex===false){idn=$.isFunction(xmlRd.id)?xmlRd.id.call(u,b):xmlRd.id}else{idn=u.p.keyIndex}if(f.length>0&&!isNaN(idn)){if(u.p.remapColumns&&u.p.remapColumns.length){idn=$.inArray(idn,u.p.remapColumns)}idn=f[idn]}if((idn+"").indexOf("[")===-1){if(f.length){getId=function(a,k){return $(idn,a).text()||k}}else{getId=function(a,k){return $(xmlRd.cell,a).eq(idn).text()||k}}}else{getId=function(a,k){return a.getAttribute(idn.replace(/[\[\]]/g,""))||k}}u.p.userData={};u.p.page=$.jgrid.getXmlData(b,xmlRd.page)||0;u.p.lastpage=$.jgrid.getXmlData(b,xmlRd.total);if(u.p.lastpage===undefined){u.p.lastpage=1}u.p.records=$.jgrid.getXmlData(b,xmlRd.records)||0;if($.isFunction(xmlRd.userdata)){u.p.userData=xmlRd.userdata.call(u,b)||{}}else{$.jgrid.getXmlData(b,xmlRd.userdata,true).each(function(){u.p.userData[this.getAttribute("name")]=$(this).text()})}var l=$.jgrid.getXmlData(b,xmlRd.root,true);l=$.jgrid.getXmlData(l,xmlRd.row,true);if(!l){l=[]}var m=l.length,j=0,grpdata=[],rn=parseInt(u.p.rowNum,10);if(m>0&&u.p.page<=0){u.p.page=1}if(l&&m){var n=u.p.scroll?$.jgrid.randId():1,altr;if(g){rn*=g+1}var o=$.isFunction(u.p.afterInsertRow),hiderow=u.p.grouping&&u.p.groupingView.groupCollapse===true;while(j<m){xmlr=l[j];rid=getId(xmlr,n+j);rid=u.p.idPrefix+rid;altr=c===0?0:c+1;cn1=(altr+j)%2==1?cn:'';var p=rowData.length;rowData.push("");if(ni){rowData.push(addRowNum(0,j,u.p.page,u.p.rowNum))}if(gi){rowData.push(addMulti(rid,ni,j))}if(si){rowData.push($(u).jqGrid("addSubGridCell",gi+ni,j+c))}if(xmlRd.repeatitems){if(!F){F=orderedCols(gi+si+ni)}var q=$.jgrid.getXmlData(xmlr,xmlRd.cell,true);$.each(F,function(k){var a=q[this];if(!a){return false}v=a.textContent||a.text;rd[u.p.colModel[k+gi+si+ni].name]=v;rowData.push(addCell(rid,v,k+gi+si+ni,j+c,xmlr))})}else{for(i=0;i<f.length;i++){v=$.jgrid.getXmlData(xmlr,f[i]);rd[u.p.colModel[i+gi+si+ni].name]=v;rowData.push(addCell(rid,v,i+gi+si+ni,j+c,xmlr))}}rowData[p]=constructTr(rid,hiderow,cn1,rd,xmlr);rowData.push("</tr>");if(u.p.grouping){grpdata=$(u).jqGrid('groupingPrepare',rowData,grpdata,rd,j);rowData=[]}if(locdata||u.p.treeGrid===true){rd[xmlid]=rid;u.p.data.push(rd);u.p._index[rid]=u.p.data.length-1}if(u.p.gridview===false){$("tbody:first",t).append(rowData.join(''));$(u).triggerHandler("jqGridAfterInsertRow",[rid,rd,xmlr]);if(o){u.p.afterInsertRow.call(u,rid,rd,xmlr)}rowData=[]}rd={};ir++;j++;if(ir==rn){break}}}if(u.p.gridview===true){fpos=u.p.treeANode>-1?u.p.treeANode:0;if(u.p.grouping){$(u).jqGrid('groupingRender',grpdata,u.p.colModel.length);grpdata=null}else if(u.p.treeGrid===true&&fpos>0){$(u.rows[fpos]).after(rowData.join(''))}else{$("tbody:first",t).append(rowData.join(''))}}if(u.p.subGrid===true){try{$(u).jqGrid("addSubGrid",gi+ni)}catch(_){}}u.p.totaltime=new Date()-h;if(ir>0){if(u.p.records===0){u.p.records=m}}rowData=null;if(u.p.treeGrid===true){try{$(u).jqGrid("setTreeNode",fpos+1,ir+fpos+1)}catch(e){}}if(!u.p.treeGrid&&!u.p.scroll){u.grid.bDiv.scrollTop=0}u.p.reccount=ir;u.p.treeANode=-1;if(u.p.userDataOnFooter){$(u).jqGrid("footerData","set",u.p.userData,true)}if(locdata){u.p.records=m;u.p.lastpage=Math.ceil(m/rn)}if(!d){u.updatepager(false,true)}if(locdata){while(ir<m){xmlr=l[ir];rid=getId(xmlr,ir+n);rid=u.p.idPrefix+rid;if(xmlRd.repeatitems){if(!F){F=orderedCols(gi+si+ni)}var r=$.jgrid.getXmlData(xmlr,xmlRd.cell,true);$.each(F,function(k){var a=r[this];if(!a){return false}v=a.textContent||a.text;rd[u.p.colModel[k+gi+si+ni].name]=v})}else{for(i=0;i<f.length;i++){v=$.jgrid.getXmlData(xmlr,f[i]);rd[u.p.colModel[i+gi+si+ni].name]=v}}rd[xmlid]=rid;u.p.data.push(rd);u.p._index[rid]=u.p.data.length-1;rd={};ir++}}},addJSONData=function(a,t,b,c,d){var g=new Date();if(a){if(u.p.treeANode===-1&&!u.p.scroll){emptyRows.call(u,false,true);b=1}else{b=b>1?b:1}}else{return}var h,locid="_id_",frd,locdata=(u.p.datatype!="local"&&u.p.loadonce)||u.p.datatype=="jsonstring";if(locdata){u.p.data=[];u.p._index={};u.p.localReader.id=locid}u.p.reccount=0;if(u.p.datatype=="local"){h=u.p.localReader;frd='local'}else{h=u.p.jsonReader;frd='json'}var k=0,v,i,j,f=[],F,cur,gi=u.p.multiselect?1:0,si=u.p.subGrid?1:0,ni=u.p.rownumbers===true?1:0,len,drows,idn,rd={},fpos,idr,rowData=[],cn=(u.p.altRows===true)?" "+u.p.altclass:"",cn1,lp;u.p.page=$.jgrid.getAccessor(a,h.page)||0;lp=$.jgrid.getAccessor(a,h.total);u.p.lastpage=lp===undefined?1:lp;u.p.records=$.jgrid.getAccessor(a,h.records)||0;u.p.userData=$.jgrid.getAccessor(a,h.userdata)||{};if(!h.repeatitems){F=f=reader(frd)}if(u.p.keyIndex===false){idn=$.isFunction(h.id)?h.id.call(u,a):h.id}else{idn=u.p.keyIndex}if(f.length>0&&!isNaN(idn)){if(u.p.remapColumns&&u.p.remapColumns.length){idn=$.inArray(idn,u.p.remapColumns)}idn=f[idn]}drows=$.jgrid.getAccessor(a,h.root);if(!drows){drows=[]}len=drows.length;i=0;if(len>0&&u.p.page<=0){u.p.page=1}var l=parseInt(u.p.rowNum,10),br=u.p.scroll?$.jgrid.randId():1,altr;if(d){l*=d+1}var m=$.isFunction(u.p.afterInsertRow),grpdata=[],hiderow=u.p.grouping&&u.p.groupingView.groupCollapse===true;while(i<len){cur=drows[i];idr=$.jgrid.getAccessor(cur,idn);if(idr===undefined){idr=br+i;if(f.length===0){if(h.cell){var n=$.jgrid.getAccessor(cur,h.cell);idr=n!==undefined?n[idn]||idr:idr;n=null}}}idr=u.p.idPrefix+idr;altr=b===1?0:b;cn1=(altr+i)%2==1?cn:'';var o=rowData.length;rowData.push("");if(ni){rowData.push(addRowNum(0,i,u.p.page,u.p.rowNum))}if(gi){rowData.push(addMulti(idr,ni,i))}if(si){rowData.push($(u).jqGrid("addSubGridCell",gi+ni,i+b))}if(h.repeatitems){if(h.cell){cur=$.jgrid.getAccessor(cur,h.cell)}if(!F){F=orderedCols(gi+si+ni)}}for(j=0;j<F.length;j++){v=$.jgrid.getAccessor(cur,F[j]);rowData.push(addCell(idr,v,j+gi+si+ni,i+b,cur));rd[u.p.colModel[j+gi+si+ni].name]=v}rowData[o]=constructTr(idr,hiderow,cn1,rd,cur);rowData.push("</tr>");if(u.p.grouping){grpdata=$(u).jqGrid('groupingPrepare',rowData,grpdata,rd,i);rowData=[]}if(locdata||u.p.treeGrid===true){rd[locid]=idr;u.p.data.push(rd);u.p._index[idr]=u.p.data.length-1}if(u.p.gridview===false){$("#"+$.jgrid.jqID(u.p.id)+" tbody:first").append(rowData.join(''));$(u).triggerHandler("jqGridAfterInsertRow",[idr,rd,cur]);if(m){u.p.afterInsertRow.call(u,idr,rd,cur)}rowData=[]}rd={};k++;i++;if(k==l){break}}if(u.p.gridview===true){fpos=u.p.treeANode>-1?u.p.treeANode:0;if(u.p.grouping){$(u).jqGrid('groupingRender',grpdata,u.p.colModel.length);grpdata=null}else if(u.p.treeGrid===true&&fpos>0){$(u.rows[fpos]).after(rowData.join(''))}else{$("#"+$.jgrid.jqID(u.p.id)+" tbody:first").append(rowData.join(''))}}if(u.p.subGrid===true){try{$(u).jqGrid("addSubGrid",gi+ni)}catch(_){}}u.p.totaltime=new Date()-g;if(k>0){if(u.p.records===0){u.p.records=len}}rowData=null;if(u.p.treeGrid===true){try{$(u).jqGrid("setTreeNode",fpos+1,k+fpos+1)}catch(e){}}if(!u.p.treeGrid&&!u.p.scroll){u.grid.bDiv.scrollTop=0}u.p.reccount=k;u.p.treeANode=-1;if(u.p.userDataOnFooter){$(u).jqGrid("footerData","set",u.p.userData,true)}if(locdata){u.p.records=len;u.p.lastpage=Math.ceil(len/l)}if(!c){u.updatepager(false,true)}if(locdata){while(k<len&&drows[k]){cur=drows[k];idr=$.jgrid.getAccessor(cur,idn);if(idr===undefined){idr=br+k;if(f.length===0){if(h.cell){var p=$.jgrid.getAccessor(cur,h.cell);idr=p[idn]||idr;p=null}}}if(cur){idr=u.p.idPrefix+idr;if(h.repeatitems){if(h.cell){cur=$.jgrid.getAccessor(cur,h.cell)}if(!F){F=orderedCols(gi+si+ni)}}for(j=0;j<F.length;j++){v=$.jgrid.getAccessor(cur,F[j]);rd[u.p.colModel[j+gi+si+ni].name]=v}rd[locid]=idr;u.p.data.push(rd);u.p._index[idr]=u.p.data.length-1;rd={}}k++}}},addLocalData=function(){var c,fndsort=false,cmtypes={},grtypes=[],grindexes=[],srcformat,sorttype,newformat;if(!$.isArray(u.p.data)){return}var d=u.p.grouping?u.p.groupingView:false,lengrp,gin;$.each(u.p.colModel,function(){sorttype=this.sorttype||"text";if(sorttype=="date"||sorttype=="datetime"){if(this.formatter&&typeof(this.formatter)==='string'&&this.formatter=='date'){if(this.formatoptions&&this.formatoptions.srcformat){srcformat=this.formatoptions.srcformat}else{srcformat=$.jgrid.formatter.date.srcformat}if(this.formatoptions&&this.formatoptions.newformat){newformat=this.formatoptions.newformat}else{newformat=$.jgrid.formatter.date.newformat}}else{srcformat=newformat=this.datefmt||"Y-m-d"}cmtypes[this.name]={"stype":sorttype,"srcfmt":srcformat,"newfmt":newformat}}else{cmtypes[this.name]={"stype":sorttype,"srcfmt":'',"newfmt":''}}if(u.p.grouping){for(gin=0,lengrp=d.groupField.length;gin<lengrp;gin++){if(this.name==d.groupField[gin]){var a=this.name;if(typeof this.index!='undefined'){a=this.index}grtypes[gin]=cmtypes[a];grindexes[gin]=a}}}if(!fndsort&&(this.index==u.p.sortname||this.name==u.p.sortname)){c=this.name;fndsort=true}});if(u.p.treeGrid){$(u).jqGrid("SortTree",c,u.p.sortorder,cmtypes[c].stype,cmtypes[c].srcfmt);return}var f={'eq':function(a){return a.equals},'ne':function(a){return a.notEquals},'lt':function(a){return a.less},'le':function(a){return a.lessOrEquals},'gt':function(a){return a.greater},'ge':function(a){return a.greaterOrEquals},'cn':function(a){return a.contains},'nc':function(a,b){return b==="OR"?a.orNot().contains:a.andNot().contains},'bw':function(a){return a.startsWith},'bn':function(a,b){return b==="OR"?a.orNot().startsWith:a.andNot().startsWith},'en':function(a,b){return b==="OR"?a.orNot().endsWith:a.andNot().endsWith},'ew':function(a){return a.endsWith},'ni':function(a,b){return b==="OR"?a.orNot().equals:a.andNot().equals},'in':function(a){return a.equals},'nu':function(a){return a.isNull},'nn':function(a,b){return b==="OR"?a.orNot().isNull:a.andNot().isNull}},query=$.jgrid.from(u.p.data);if(u.p.ignoreCase){query=query.ignoreCase()}function tojLinq(a){var s=0,index,gor,ror,opr,rule;if(a.groups!==undefined){gor=a.groups.length&&a.groupOp.toString().toUpperCase()==="OR";if(gor){query.orBegin()}for(index=0;index<a.groups.length;index++){if(s>0&&gor){query.or()}try{tojLinq(a.groups[index])}catch(e){alert(e)}s++}if(gor){query.orEnd()}}if(a.rules!==undefined){if(s>0){var b=query.select();query=$.jgrid.from(b);if(u.p.ignoreCase){query=query.ignoreCase()}}try{ror=a.rules.length&&a.groupOp.toString().toUpperCase()==="OR";if(ror){query.orBegin()}for(index=0;index<a.rules.length;index++){rule=a.rules[index];opr=a.groupOp.toString().toUpperCase();if(f[rule.op]&&rule.field){if(s>0&&opr&&opr==="OR"){query=query.or()}query=f[rule.op](query,opr)(rule.field,rule.data,cmtypes[rule.field])}s++}if(ror){query.orEnd()}}catch(g){alert(g)}}}if(u.p.search===true){var h=u.p.postData.filters;if(h){if(typeof h=="string"){h=$.jgrid.parse(h)}tojLinq(h)}else{try{query=f[u.p.postData.searchOper](query)(u.p.postData.searchField,u.p.postData.searchString,cmtypes[u.p.postData.searchField])}catch(se){}}}if(u.p.grouping){for(gin=0;gin<lengrp;gin++){query.orderBy(grindexes[gin],d.groupOrder[gin],grtypes[gin].stype,grtypes[gin].srcfmt)}}if(c&&u.p.sortorder&&fndsort){if(u.p.sortorder.toUpperCase()=="DESC"){query.orderBy(u.p.sortname,"d",cmtypes[c].stype,cmtypes[c].srcfmt)}else{query.orderBy(u.p.sortname,"a",cmtypes[c].stype,cmtypes[c].srcfmt)}}var i=query.select(),recordsperpage=parseInt(u.p.rowNum,10),total=i.length,page=parseInt(u.p.page,10),totalpages=Math.ceil(total/recordsperpage),retresult={};i=i.slice((page-1)*recordsperpage,page*recordsperpage);query=null;cmtypes=null;retresult[u.p.localReader.total]=totalpages;retresult[u.p.localReader.page]=page;retresult[u.p.localReader.records]=total;retresult[u.p.localReader.root]=i;retresult[u.p.localReader.userdata]=u.p.userData;i=null;return retresult},updatepager=function(a,b){var c,last,base,from,to,tot,fmt,pgboxes="",sppg,tspg=u.p.pager?"_"+$.jgrid.jqID(u.p.pager.substr(1)):"",tspg_t=u.p.toppager?"_"+u.p.toppager.substr(1):"";base=parseInt(u.p.page,10)-1;if(base<0){base=0}base=base*parseInt(u.p.rowNum,10);to=base+u.p.reccount;if(u.p.scroll){var d=$("tbody:first > tr:gt(0)",u.grid.bDiv);base=to-d.length;u.p.reccount=d.length;var e=d.outerHeight()||u.grid.prevRowHeight;if(e){var f=base*e;var g=parseInt(u.p.records,10)*e;$(">div:first",u.grid.bDiv).css({height:g}).children("div:first").css({height:f,display:f?"":"none"})}u.grid.bDiv.scrollLeft=u.grid.hDiv.scrollLeft}pgboxes=u.p.pager?u.p.pager:"";pgboxes+=u.p.toppager?(pgboxes?","+u.p.toppager:u.p.toppager):"";if(pgboxes){fmt=$.jgrid.formatter.integer||{};c=intNum(u.p.page);last=intNum(u.p.lastpage);$(".selbox",pgboxes)[this.p.useProp?'prop':'attr']("disabled",false);if(u.p.pginput===true){$('.ui-pg-input',pgboxes).val(u.p.page);sppg=u.p.toppager?'#sp_1'+tspg+",#sp_1"+tspg_t:'#sp_1'+tspg;$(sppg).html($.fmatter?$.fmatter.util.NumberFormat(u.p.lastpage,fmt):u.p.lastpage)}if(u.p.viewrecords){if(u.p.reccount===0){$(".ui-paging-info",pgboxes).html(u.p.emptyrecords)}else{from=base+1;tot=u.p.records;if($.fmatter){from=$.fmatter.util.NumberFormat(from,fmt);to=$.fmatter.util.NumberFormat(to,fmt);tot=$.fmatter.util.NumberFormat(tot,fmt)}$(".ui-paging-info",pgboxes).html($.jgrid.format(u.p.recordtext,from,to,tot))}}if(u.p.pgbuttons===true){if(c<=0){c=last=0}if(c==1||c===0){$("#first"+tspg+", #prev"+tspg).addClass('ui-state-disabled').removeClass('ui-state-hover');if(u.p.toppager){$("#first_t"+tspg_t+", #prev_t"+tspg_t).addClass('ui-state-disabled').removeClass('ui-state-hover')}}else{$("#first"+tspg+", #prev"+tspg).removeClass('ui-state-disabled');if(u.p.toppager){$("#first_t"+tspg_t+", #prev_t"+tspg_t).removeClass('ui-state-disabled')}}if(c==last||c===0){$("#next"+tspg+", #last"+tspg).addClass('ui-state-disabled').removeClass('ui-state-hover');if(u.p.toppager){$("#next_t"+tspg_t+", #last_t"+tspg_t).addClass('ui-state-disabled').removeClass('ui-state-hover')}}else{$("#next"+tspg+", #last"+tspg).removeClass('ui-state-disabled');if(u.p.toppager){$("#next_t"+tspg_t+", #last_t"+tspg_t).removeClass('ui-state-disabled')}}}}if(a===true&&u.p.rownumbers===true){$("td.jqgrid-rownum",u.rows).each(function(i){$(this).html(base+1+i)})}if(b&&u.p.jqgdnd){$(u).jqGrid('gridDnD','updateDnD')}$(u).triggerHandler("jqGridGridComplete");if($.isFunction(u.p.gridComplete)){u.p.gridComplete.call(u)}$(u).triggerHandler("jqGridAfterGridComplete")},beginReq=function(){u.grid.hDiv.loading=true;if(u.p.hiddengrid){return}switch(u.p.loadui){case"disable":break;case"enable":$("#load_"+$.jgrid.jqID(u.p.id)).show();break;case"block":$("#lui_"+$.jgrid.jqID(u.p.id)).show();$("#load_"+$.jgrid.jqID(u.p.id)).show();break}},endReq=function(){u.grid.hDiv.loading=false;switch(u.p.loadui){case"disable":break;case"enable":$("#load_"+$.jgrid.jqID(u.p.id)).hide();break;case"block":$("#lui_"+$.jgrid.jqID(u.p.id)).hide();$("#load_"+$.jgrid.jqID(u.p.id)).hide();break}},populate=function(d){if(!u.grid.hDiv.loading){var e=u.p.scroll&&d===false,prm={},dt,dstr,pN=u.p.prmNames;if(u.p.page<=0){u.p.page=1}if(pN.search!==null){prm[pN.search]=u.p.search}if(pN.nd!==null){prm[pN.nd]=new Date().getTime()}if(pN.rows!==null){prm[pN.rows]=u.p.rowNum}if(pN.page!==null){prm[pN.page]=u.p.page}if(pN.sort!==null){prm[pN.sort]=u.p.sortname}if(pN.order!==null){prm[pN.order]=u.p.sortorder}if(u.p.rowTotal!==null&&pN.totalrows!==null){prm[pN.totalrows]=u.p.rowTotal}var f=$.isFunction(u.p.loadComplete),lc=f?u.p.loadComplete:null;var g=0;d=d||1;if(d>1){if(pN.npage!==null){prm[pN.npage]=d;g=d-1;d=1}else{lc=function(a){u.p.page++;u.grid.hDiv.loading=false;if(f){u.p.loadComplete.call(u,a)}populate(d-1)}}}else if(pN.npage!==null){delete u.p.postData[pN.npage]}if(u.p.grouping){$(u).jqGrid('groupingSetup');var h=u.p.groupingView,gi,gs="";for(gi=0;gi<h.groupField.length;gi++){gs+=h.groupField[gi]+" "+h.groupOrder[gi]+", "}prm[pN.sort]=gs+prm[pN.sort]}$.extend(u.p.postData,prm);var i=!u.p.scroll?1:u.rows.length-1;var j=$(u).triggerHandler("jqGridBeforeRequest");if(j===false||j==='stop'){return}if($.isFunction(u.p.datatype)){u.p.datatype.call(u,u.p.postData,"load_"+u.p.id);return}else if($.isFunction(u.p.beforeRequest)){j=u.p.beforeRequest.call(u);if(j===undefined){j=true}if(j===false){return}}dt=u.p.datatype.toLowerCase();switch(dt){case"json":case"jsonp":case"xml":case"script":$.ajax($.extend({url:u.p.url,type:u.p.mtype,dataType:dt,data:$.isFunction(u.p.serializeGridData)?u.p.serializeGridData.call(u,u.p.postData):u.p.postData,success:function(a,b,c){if($.isFunction(u.p.beforeProcessing)){if(u.p.beforeProcessing.call(u,a,b,c)===false){endReq();return}}if(dt==="xml"){addXmlData(a,u.grid.bDiv,i,d>1,g)}else{addJSONData(a,u.grid.bDiv,i,d>1,g)}$(u).triggerHandler("jqGridLoadComplete",[a]);if(lc){lc.call(u,a)}$(u).triggerHandler("jqGridAfterLoadComplete",[a]);if(e){u.grid.populateVisible()}if(u.p.loadonce||u.p.treeGrid){u.p.datatype="local"}a=null;if(d===1){endReq()}},error:function(a,b,c){if($.isFunction(u.p.loadError)){u.p.loadError.call(u,a,b,c)}if(d===1){endReq()}a=null},beforeSend:function(a,b){var c=true;if($.isFunction(u.p.loadBeforeSend)){c=u.p.loadBeforeSend.call(u,a,b)}if(c===undefined){c=true}if(c===false){return false}else{beginReq()}}},$.jgrid.ajaxOptions,u.p.ajaxGridOptions));break;case"xmlstring":beginReq();dstr=$.jgrid.stringToDoc(u.p.datastr);addXmlData(dstr,u.grid.bDiv);$(u).triggerHandler("jqGridLoadComplete",[dstr]);if(f){u.p.loadComplete.call(u,dstr)}$(u).triggerHandler("jqGridAfterLoadComplete",[dstr]);u.p.datatype="local";u.p.datastr=null;endReq();break;case"jsonstring":beginReq();if(typeof u.p.datastr=='string'){dstr=$.jgrid.parse(u.p.datastr)}else{dstr=u.p.datastr}addJSONData(dstr,u.grid.bDiv);$(u).triggerHandler("jqGridLoadComplete",[dstr]);if(f){u.p.loadComplete.call(u,dstr)}$(u).triggerHandler("jqGridAfterLoadComplete",[dstr]);u.p.datatype="local";u.p.datastr=null;endReq();break;case"local":case"clientside":beginReq();u.p.datatype="local";var k=addLocalData();addJSONData(k,u.grid.bDiv,i,d>1,g);$(u).triggerHandler("jqGridLoadComplete",[k]);if(lc){lc.call(u,k)}$(u).triggerHandler("jqGridAfterLoadComplete",[k]);if(e){u.grid.populateVisible()}endReq();break}}},setHeadCheckBox=function(a){$('#cb_'+$.jgrid.jqID(u.p.id),u.grid.hDiv)[u.p.useProp?'prop':'attr']("checked",a);var b=u.p.frozenColumns?u.p.id+"_frozen":"";if(b){$('#cb_'+$.jgrid.jqID(u.p.id),u.grid.fhDiv)[u.p.useProp?'prop':'attr']("checked",a)}},setPager=function(c,d){var f="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>",pginp="",pgl="<table cellspacing='0' cellpadding='0' border='0' style='table-layout:auto;' class='ui-pg-table'><tbody><tr>",str="",pgcnt,lft,cent,rgt,twd,tdw,i,clearVals=function(a){var b;if($.isFunction(u.p.onPaging)){b=u.p.onPaging.call(u,a)}u.p.selrow=null;if(u.p.multiselect){u.p.selarrrow=[];setHeadCheckBox(false)}u.p.savedRow=[];if(b=='stop'){return false}return true};c=c.substr(1);d+="_"+c;pgcnt="pg_"+c;lft=c+"_left";cent=c+"_center";rgt=c+"_right";$("#"+$.jgrid.jqID(c)).append("<div id='"+pgcnt+"' class='ui-pager-control' role='group'><table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table' style='width:100%;table-layout:fixed;height:100%;' role='row'><tbody><tr><td id='"+lft+"' align='left'></td><td id='"+cent+"' align='center' style='white-space:pre;'></td><td id='"+rgt+"' align='right'></td></tr></tbody></table></div>").attr("dir","ltr");if(u.p.rowList.length>0){str="<td dir='"+dir+"'>";str+="<select class='ui-pg-selbox' role='listbox'>";for(i=0;i<u.p.rowList.length;i++){str+="<option role=\"option\" value=\""+u.p.rowList[i]+"\""+((u.p.rowNum==u.p.rowList[i])?" selected=\"selected\"":"")+">"+u.p.rowList[i]+"</option>"}str+="</select></td>"}if(dir=="rtl"){pgl+=str}if(u.p.pginput===true){pginp="<td dir='"+dir+"'>"+$.jgrid.format(u.p.pgtext||"","<input class='ui-pg-input' type='text' size='2' maxlength='7' value='0' role='textbox'/>","<span id='sp_1_"+$.jgrid.jqID(c)+"'></span>")+"</td>"}if(u.p.pgbuttons===true){var g=["first"+d,"prev"+d,"next"+d,"last"+d];if(dir=="rtl"){g.reverse()}pgl+="<td id='"+g[0]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-first'></span></td>";pgl+="<td id='"+g[1]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-prev'></span></td>";pgl+=pginp!==""?f+pginp+f:"";pgl+="<td id='"+g[2]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-next'></span></td>";pgl+="<td id='"+g[3]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-end'></span></td>"}else if(pginp!==""){pgl+=pginp}if(dir=="ltr"){pgl+=str}pgl+="</tr></tbody></table>";if(u.p.viewrecords===true){$("td#"+c+"_"+u.p.recordpos,"#"+pgcnt).append("<div dir='"+dir+"' style='text-align:"+u.p.recordpos+"' class='ui-paging-info'></div>")}$("td#"+c+"_"+u.p.pagerpos,"#"+pgcnt).append(pgl);tdw=$(".ui-jqgrid").css("font-size")||"11px";$(document.body).append("<div id='testpg' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+tdw+";visibility:hidden;' ></div>");twd=$(pgl).clone().appendTo("#testpg").width();$("#testpg").remove();if(twd>0){if(pginp!==""){twd+=50}$("td#"+c+"_"+u.p.pagerpos,"#"+pgcnt).width(twd)}u.p._nvtd=[];u.p._nvtd[0]=twd?Math.floor((u.p.width-twd)/2):Math.floor(u.p.width/3);u.p._nvtd[1]=0;pgl=null;$('.ui-pg-selbox',"#"+pgcnt).bind('change',function(){u.p.page=Math.round(u.p.rowNum*(u.p.page-1)/this.value-0.5)+1;u.p.rowNum=this.value;if(u.p.pager){$('.ui-pg-selbox',u.p.pager).val(this.value)}if(u.p.toppager){$('.ui-pg-selbox',u.p.toppager).val(this.value)}if(!clearVals('records')){return false}populate();return false});if(u.p.pgbuttons===true){$(".ui-pg-button","#"+pgcnt).hover(function(){if($(this).hasClass('ui-state-disabled')){this.style.cursor='default'}else{$(this).addClass('ui-state-hover');this.style.cursor='pointer'}},function(){if(!$(this).hasClass('ui-state-disabled')){$(this).removeClass('ui-state-hover');this.style.cursor="default"}});$("#first"+$.jgrid.jqID(d)+", #prev"+$.jgrid.jqID(d)+", #next"+$.jgrid.jqID(d)+", #last"+$.jgrid.jqID(d)).click(function(){var a=intNum(u.p.page,1),last=intNum(u.p.lastpage,1),selclick=false,fp=true,pp=true,np=true,lp=true;if(last===0||last===1){fp=false;pp=false;np=false;lp=false}else if(last>1&&a>=1){if(a===1){fp=false;pp=false}else if(a===last){np=false;lp=false}}else if(last>1&&a===0){np=false;lp=false;a=last-1}if(this.id==='first'+d&&fp){u.p.page=1;selclick=true}if(this.id==='prev'+d&&pp){u.p.page=(a-1);selclick=true}if(this.id==='next'+d&&np){u.p.page=(a+1);selclick=true}if(this.id==='last'+d&&lp){u.p.page=last;selclick=true}if(selclick){if(!clearVals(this.id)){return false}populate()}return false})}if(u.p.pginput===true){$('input.ui-pg-input',"#"+pgcnt).keydown(function(e){var a=e.charCode?e.charCode:e.keyCode?e.keyCode:0;if(a==13){u.p.page=($(this).val()>0)?$(this).val():u.p.page;if(!clearVals('user')){return false}populate();return false}return this})}},sortData=function(a,b,c,d){if(!u.p.colModel[b].sortable){return}var e;if(u.p.savedRow.length>0){return}if(!c){if(u.p.lastsort==b){if(u.p.sortorder=='asc'){u.p.sortorder='desc'}else if(u.p.sortorder=='desc'){u.p.sortorder='asc'}}else{u.p.sortorder=u.p.colModel[b].firstsortorder||'desc'}u.p.page=1}if(d){if(u.p.lastsort==b&&u.p.sortorder==d&&!c){return}else{u.p.sortorder=d}}var f=u.grid.headers[u.p.lastsort].el,newSelectedTh=u.grid.headers[b].el;$("span.ui-grid-ico-sort",f).addClass('ui-state-disabled');$(f).attr("aria-selected","false");$("span.ui-icon-"+u.p.sortorder,newSelectedTh).removeClass('ui-state-disabled');$(newSelectedTh).attr("aria-selected","true");if(!u.p.viewsortcols[0]){if(u.p.lastsort!=b){$("span.s-ico",f).hide();$("span.s-ico",newSelectedTh).show()}}a=a.substring(5+u.p.id.length+1);u.p.sortname=u.p.colModel[b].index||a;e=u.p.sortorder;if($(u).triggerHandler("jqGridSortCol",[a,b,e])==='stop'){u.p.lastsort=b;return}if($.isFunction(u.p.onSortCol)){if(u.p.onSortCol.call(u,a,b,e)=='stop'){u.p.lastsort=b;return}}if(u.p.datatype=="local"){if(u.p.deselectAfterSort){$(u).jqGrid("resetSelection")}}else{u.p.selrow=null;if(u.p.multiselect){setHeadCheckBox(false)}u.p.selarrrow=[];u.p.savedRow=[]}if(u.p.scroll){var g=u.grid.bDiv.scrollLeft;emptyRows.call(u,true,false);u.grid.hDiv.scrollLeft=g}if(u.p.subGrid&&u.p.datatype=='local'){$("td.sgexpanded","#"+$.jgrid.jqID(u.p.id)).each(function(){$(this).trigger("click")})}populate();u.p.lastsort=b;if(u.p.sortname!=a&&b){u.p.lastsort=b}},setColWidth=function(){var a=0,brd=$.jgrid.cellWidth()?0:intNum(u.p.cellLayout,0),vc=0,lvc,scw=intNum(u.p.scrollOffset,0),cw,hs=false,aw,gw=0,cl=0,cr;$.each(u.p.colModel,function(){if(typeof this.hidden==='undefined'){this.hidden=false}this.widthOrg=cw=intNum(this.width,0);if(this.hidden===false){a+=cw+brd;if(this.fixed){gw+=cw+brd}else{vc++}cl++}});if(isNaN(u.p.width)){u.p.width=a+((u.p.shrinkToFit===false&&!isNaN(u.p.height))?scw:0)}grid.width=u.p.width;u.p.tblwidth=a;if(u.p.shrinkToFit===false&&u.p.forceFit===true){u.p.forceFit=false}if(u.p.shrinkToFit===true&&vc>0){aw=grid.width-brd*vc-gw;if(!isNaN(u.p.height)){aw-=scw;hs=true}a=0;$.each(u.p.colModel,function(i){if(this.hidden===false&&!this.fixed){cw=Math.round(aw*this.width/(u.p.tblwidth-brd*vc-gw));this.width=cw;a+=cw;lvc=i}});cr=0;if(hs){if(grid.width-gw-(a+brd*vc)!==scw){cr=grid.width-gw-(a+brd*vc)-scw}}else if(!hs&&Math.abs(grid.width-gw-(a+brd*vc))!==1){cr=grid.width-gw-(a+brd*vc)}u.p.colModel[lvc].width+=cr;u.p.tblwidth=a+cr+brd*vc+gw;if(u.p.tblwidth>u.p.width){u.p.colModel[lvc].width-=(u.p.tblwidth-parseInt(u.p.width,10));u.p.tblwidth=u.p.width}}},nextVisible=function(a){var b=a,j=a,i;for(i=a+1;i<u.p.colModel.length;i++){if(u.p.colModel[i].hidden!==true){j=i;break}}return j-b},getOffset=function(a){var i,ret={},brd1=$.jgrid.cellWidth()?0:u.p.cellLayout;ret[0]=ret[1]=ret[2]=0;for(i=0;i<=a;i++){if(u.p.colModel[i].hidden===false){ret[0]+=u.p.colModel[i].width+brd1}}if(u.p.direction=="rtl"){ret[0]=u.p.width-ret[0]}ret[0]=ret[0]-u.grid.bDiv.scrollLeft;if($(u.grid.cDiv).is(":visible")){ret[1]+=$(u.grid.cDiv).height()+parseInt($(u.grid.cDiv).css("padding-top"),10)+parseInt($(u.grid.cDiv).css("padding-bottom"),10)}if(u.p.toolbar[0]===true&&(u.p.toolbar[1]=='top'||u.p.toolbar[1]=='both')){ret[1]+=$(u.grid.uDiv).height()+parseInt($(u.grid.uDiv).css("border-top-width"),10)+parseInt($(u.grid.uDiv).css("border-bottom-width"),10)}if(u.p.toppager){ret[1]+=$(u.grid.topDiv).height()+parseInt($(u.grid.topDiv).css("border-bottom-width"),10)}ret[2]+=$(u.grid.bDiv).height()+$(u.grid.hDiv).height();return ret},getColumnHeaderIndex=function(a){var i,headers=u.grid.headers,ci=$.jgrid.getCellIndex(a);for(i=0;i<headers.length;i++){if(a===headers[i].el){ci=i;break}}return ci};this.p.id=this.id;if($.inArray(u.p.multikey,B)==-1){u.p.multikey=false}u.p.keyIndex=false;for(i=0;i<u.p.colModel.length;i++){u.p.colModel[i]=$.extend(true,{},u.p.cmTemplate,u.p.colModel[i].template||{},u.p.colModel[i]);if(u.p.keyIndex===false&&u.p.colModel[i].key===true){u.p.keyIndex=i}}u.p.sortorder=u.p.sortorder.toLowerCase();if(u.p.grouping===true){u.p.scroll=false;u.p.rownumbers=false;u.p.treeGrid=false;u.p.gridview=true}if(this.p.treeGrid===true){try{$(this).jqGrid("setTreeGrid")}catch(_){}if(u.p.datatype!="local"){u.p.localReader={id:"_id_"}}}if(this.p.subGrid){try{$(u).jqGrid("setSubGrid")}catch(s){}}if(this.p.multiselect){this.p.colNames.unshift("<input role='checkbox' id='cb_"+this.p.id+"' class='cbox' type='checkbox'/>");this.p.colModel.unshift({name:'cb',width:$.jgrid.cellWidth()?u.p.multiselectWidth+u.p.cellLayout:u.p.multiselectWidth,sortable:false,resizable:false,hidedlg:true,search:false,align:'center',fixed:true})}if(this.p.rownumbers){this.p.colNames.unshift("");this.p.colModel.unshift({name:'rn',width:u.p.rownumWidth,sortable:false,resizable:false,hidedlg:true,search:false,align:'center',fixed:true})}u.p.xmlReader=$.extend(true,{root:"rows",row:"row",page:"rows>page",total:"rows>total",records:"rows>records",repeatitems:true,cell:"cell",id:"[id]",userdata:"userdata",subgrid:{root:"rows",row:"row",repeatitems:true,cell:"cell"}},u.p.xmlReader);u.p.jsonReader=$.extend(true,{root:"rows",page:"page",total:"total",records:"records",repeatitems:true,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:true,cell:"cell"}},u.p.jsonReader);u.p.localReader=$.extend(true,{root:"rows",page:"page",total:"total",records:"records",repeatitems:false,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:true,cell:"cell"}},u.p.localReader);if(u.p.scroll){u.p.pgbuttons=false;u.p.pginput=false;u.p.rowList=[]}if(u.p.data.length){refreshIndex()}var C="<thead><tr class='ui-jqgrid-labels' role='rowheader'>",tdc,idn,w,res,sort,td,ptr,tbody,imgs,iac="",idc="";if(u.p.shrinkToFit===true&&u.p.forceFit===true){for(i=u.p.colModel.length-1;i>=0;i--){if(!u.p.colModel[i].hidden){u.p.colModel[i].resizable=false;break}}}if(u.p.viewsortcols[1]=='horizontal'){iac=" ui-i-asc";idc=" ui-i-desc"}tdc=isMSIE?"class='ui-th-div-ie'":"";imgs="<span class='s-ico' style='display:none'><span sort='asc' class='ui-grid-ico-sort ui-icon-asc"+iac+" ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-"+dir+"'></span>";imgs+="<span sort='desc' class='ui-grid-ico-sort ui-icon-desc"+idc+" ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-"+dir+"'></span></span>";for(i=0;i<this.p.colNames.length;i++){var D=u.p.headertitles?(" title=\""+$.jgrid.stripHtml(u.p.colNames[i])+"\""):"";C+="<th id='"+u.p.id+"_"+u.p.colModel[i].name+"' role='columnheader' class='ui-state-default ui-th-column ui-th-"+dir+"'"+D+">";idn=u.p.colModel[i].index||u.p.colModel[i].name;C+="<div id='jqgh_"+u.p.id+"_"+u.p.colModel[i].name+"' "+tdc+">"+u.p.colNames[i];if(!u.p.colModel[i].width){u.p.colModel[i].width=150}else{u.p.colModel[i].width=parseInt(u.p.colModel[i].width,10)}if(typeof(u.p.colModel[i].title)!=="boolean"){u.p.colModel[i].title=true}if(idn==u.p.sortname){u.p.lastsort=i}C+=imgs+"</div></th>"}C+="</tr></thead>";imgs=null;$(this).append(C);$("thead tr:first th",this).hover(function(){$(this).addClass('ui-state-hover')},function(){$(this).removeClass('ui-state-hover')});if(this.p.multiselect){var E=[],chk;$('#cb_'+$.jgrid.jqID(u.p.id),this).bind('click',function(){u.p.selarrrow=[];var a=u.p.frozenColumns===true?u.p.id+"_frozen":"";if(this.checked){$(u.rows).each(function(i){if(i>0){if(!$(this).hasClass("ui-subgrid")&&!$(this).hasClass("jqgroup")&&!$(this).hasClass('ui-state-disabled')){$("#jqg_"+$.jgrid.jqID(u.p.id)+"_"+$.jgrid.jqID(this.id))[u.p.useProp?'prop':'attr']("checked",true);$(this).addClass("ui-state-highlight").attr("aria-selected","true");u.p.selarrrow.push(this.id);u.p.selrow=this.id;if(a){$("#jqg_"+$.jgrid.jqID(u.p.id)+"_"+$.jgrid.jqID(this.id),u.grid.fbDiv)[u.p.useProp?'prop':'attr']("checked",true);$("#"+$.jgrid.jqID(this.id),u.grid.fbDiv).addClass("ui-state-highlight")}}}});chk=true;E=[]}else{$(u.rows).each(function(i){if(i>0){if(!$(this).hasClass("ui-subgrid")&&!$(this).hasClass('ui-state-disabled')){$("#jqg_"+$.jgrid.jqID(u.p.id)+"_"+$.jgrid.jqID(this.id))[u.p.useProp?'prop':'attr']("checked",false);$(this).removeClass("ui-state-highlight").attr("aria-selected","false");E.push(this.id);if(a){$("#jqg_"+$.jgrid.jqID(u.p.id)+"_"+$.jgrid.jqID(this.id),u.grid.fbDiv)[u.p.useProp?'prop':'attr']("checked",false);$("#"+$.jgrid.jqID(this.id),u.grid.fbDiv).removeClass("ui-state-highlight")}}}});u.p.selrow=null;chk=false}$(u).triggerHandler("jqGridSelectAll",[chk?u.p.selarrrow:E,chk]);if($.isFunction(u.p.onSelectAll)){u.p.onSelectAll.call(u,chk?u.p.selarrrow:E,chk)}})}if(u.p.autowidth===true){var G=$(A).innerWidth();u.p.width=G>0?G:'nw'}setColWidth();$(A).css("width",grid.width+"px").append("<div class='ui-jqgrid-resize-mark' id='rs_m"+u.p.id+"'>&#160;</div>");$(z).css("width",grid.width+"px");C=$("thead:first",u).get(0);var H="";if(u.p.footerrow){H+="<table role='grid' style='width:"+u.p.tblwidth+"px' class='ui-jqgrid-ftable' cellspacing='0' cellpadding='0' border='0'><tbody><tr role='row' class='ui-widget-content footrow footrow-"+dir+"'>"}var I=$("tr:first",C),firstr="<tr class='jqgfirstrow' role='row' style='height:auto'>";u.p.disableClick=false;$("th",I).each(function(j){w=u.p.colModel[j].width;if(typeof u.p.colModel[j].resizable==='undefined'){u.p.colModel[j].resizable=true}if(u.p.colModel[j].resizable){res=document.createElement("span");$(res).html("&#160;").addClass('ui-jqgrid-resize ui-jqgrid-resize-'+dir);if(!$.browser.opera){$(res).css("cursor","col-resize")}$(this).addClass(u.p.resizeclass)}else{res=""}$(this).css("width",w+"px").prepend(res);var a="";if(u.p.colModel[j].hidden){$(this).css("display","none");a="display:none;"}firstr+="<td role='gridcell' style='height:0px;width:"+w+"px;"+a+"'></td>";grid.headers[j]={width:w,el:this};sort=u.p.colModel[j].sortable;if(typeof sort!=='boolean'){u.p.colModel[j].sortable=true;sort=true}var b=u.p.colModel[j].name;if(!(b=='cb'||b=='subgrid'||b=='rn')){if(u.p.viewsortcols[2]){$(">div",this).addClass('ui-jqgrid-sortable')}}if(sort){if(u.p.viewsortcols[0]){$("div span.s-ico",this).show();if(j==u.p.lastsort){$("div span.ui-icon-"+u.p.sortorder,this).removeClass("ui-state-disabled")}}else if(j==u.p.lastsort){$("div span.s-ico",this).show();$("div span.ui-icon-"+u.p.sortorder,this).removeClass("ui-state-disabled")}}if(u.p.footerrow){H+="<td role='gridcell' "+formatCol(j,0,'',null,'',false)+">&#160;</td>"}}).mousedown(function(e){if($(e.target).closest("th>span.ui-jqgrid-resize").length!=1){return}var a=getColumnHeaderIndex(this);if(u.p.forceFit===true){u.p.nv=nextVisible(a)}grid.dragStart(a,e,getOffset(a));return false}).click(function(e){if(u.p.disableClick){u.p.disableClick=false;return false}var s="th>div.ui-jqgrid-sortable",r,d;if(!u.p.viewsortcols[2]){s="th>div>span>span.ui-grid-ico-sort"}var t=$(e.target).closest(s);if(t.length!=1){return}var a=getColumnHeaderIndex(this);if(!u.p.viewsortcols[2]){r=true;d=t.attr("sort")}sortData($('div',this)[0].id,a,r,d);return false});if(u.p.sortable&&$.fn.sortable){try{$(u).jqGrid("sortableColumns",I)}catch(e){}}if(u.p.footerrow){H+="</tr></tbody></table>"}firstr+="</tr>";tbody=document.createElement("tbody");this.appendChild(tbody);$(this).addClass('ui-jqgrid-btable').append(firstr);firstr=null;var J=$("<table class='ui-jqgrid-htable' style='width:"+u.p.tblwidth+"px' role='grid' aria-labelledby='gbox_"+this.id+"' cellspacing='0' cellpadding='0' border='0'></table>").append(C),hg=(u.p.caption&&u.p.hiddengrid===true)?true:false,hb=$("<div class='ui-jqgrid-hbox"+(dir=="rtl"?"-rtl":"")+"'></div>");C=null;grid.hDiv=document.createElement("div");$(grid.hDiv).css({width:grid.width+"px"}).addClass("ui-state-default ui-jqgrid-hdiv").append(hb);$(hb).append(J);J=null;if(hg){$(grid.hDiv).hide()}if(u.p.pager){if(typeof u.p.pager=="string"){if(u.p.pager.substr(0,1)!="#"){u.p.pager="#"+u.p.pager}}else{u.p.pager="#"+$(u.p.pager).attr("id")}$(u.p.pager).css({width:grid.width+"px"}).appendTo(A).addClass('ui-state-default ui-jqgrid-pager ui-corner-bottom');if(hg){$(u.p.pager).hide()}setPager(u.p.pager,'')}if(u.p.cellEdit===false&&u.p.hoverrows===true){$(u).bind('mouseover',function(e){ptr=$(e.target).closest("tr.jqgrow");if($(ptr).attr("class")!=="ui-subgrid"){$(ptr).addClass("ui-state-hover")}}).bind('mouseout',function(e){ptr=$(e.target).closest("tr.jqgrow");$(ptr).removeClass("ui-state-hover")})}var K,ci,tdHtml;$(u).before(grid.hDiv).click(function(e){td=e.target;ptr=$(td,u.rows).closest("tr.jqgrow");if($(ptr).length===0||ptr[0].className.indexOf('ui-state-disabled')>-1||($(td,u).closest("table.ui-jqgrid-btable").attr('id')||'').replace("_frozen","")!==u.id){return this}var b=$(td).hasClass("cbox"),cSel=$(u).triggerHandler("jqGridBeforeSelectRow",[ptr[0].id,e]);cSel=(cSel===false||cSel==='stop')?false:true;if(cSel&&$.isFunction(u.p.beforeSelectRow)){cSel=u.p.beforeSelectRow.call(u,ptr[0].id,e)}if(td.tagName=='A'||((td.tagName=='INPUT'||td.tagName=='TEXTAREA'||td.tagName=='OPTION'||td.tagName=='SELECT')&&!b)){return}if(cSel===true){K=ptr[0].id;ci=$.jgrid.getCellIndex(td);tdHtml=$(td).closest("td,th").html();$(u).triggerHandler("jqGridCellSelect",[K,ci,tdHtml,e]);if($.isFunction(u.p.onCellSelect)){u.p.onCellSelect.call(u,K,ci,tdHtml,e)}if(u.p.cellEdit===true){if(u.p.multiselect&&b){$(u).jqGrid("setSelection",K,true,e)}else{K=ptr[0].rowIndex;try{$(u).jqGrid("editCell",K,ci,true)}catch(_){}}}else if(!u.p.multikey){if(u.p.multiselect&&u.p.multiboxonly){if(b){$(u).jqGrid("setSelection",K,true,e)}else{var c=u.p.frozenColumns?u.p.id+"_frozen":"";$(u.p.selarrrow).each(function(i,n){var a=u.rows.namedItem(n);$(a).removeClass("ui-state-highlight");$("#jqg_"+$.jgrid.jqID(u.p.id)+"_"+$.jgrid.jqID(n))[u.p.useProp?'prop':'attr']("checked",false);if(c){$("#"+$.jgrid.jqID(n),"#"+$.jgrid.jqID(c)).removeClass("ui-state-highlight");$("#jqg_"+$.jgrid.jqID(u.p.id)+"_"+$.jgrid.jqID(n),"#"+$.jgrid.jqID(c))[u.p.useProp?'prop':'attr']("checked",false)}});u.p.selarrrow=[];$(u).jqGrid("setSelection",K,true,e)}}else{$(u).jqGrid("setSelection",K,true,e)}}else{if(e[u.p.multikey]){$(u).jqGrid("setSelection",K,true,e)}else if(u.p.multiselect&&b){b=$("#jqg_"+$.jgrid.jqID(u.p.id)+"_"+K).is(":checked");$("#jqg_"+$.jgrid.jqID(u.p.id)+"_"+K)[u.p.useProp?'prop':'attr']("checked",b)}}}}).bind('reloadGrid',function(e,a){if(u.p.treeGrid===true){u.p.datatype=u.p.treedatatype}if(a&&a.current){u.grid.selectionPreserver(u)}if(u.p.datatype=="local"){$(u).jqGrid("resetSelection");if(u.p.data.length){refreshIndex()}}else if(!u.p.treeGrid){u.p.selrow=null;if(u.p.multiselect){u.p.selarrrow=[];setHeadCheckBox(false)}u.p.savedRow=[]}if(u.p.scroll){emptyRows.call(u,true,false)}if(a&&a.page){var b=a.page;if(b>u.p.lastpage){b=u.p.lastpage}if(b<1){b=1}u.p.page=b;if(u.grid.prevRowHeight){u.grid.bDiv.scrollTop=(b-1)*u.grid.prevRowHeight*u.p.rowNum}else{u.grid.bDiv.scrollTop=0}}if(u.grid.prevRowHeight&&u.p.scroll){delete u.p.lastpage;u.grid.populateVisible()}else{u.grid.populate()}if(u.p._inlinenav===true){$(u).jqGrid('showAddEditButtons')}return false}).dblclick(function(e){td=e.target;ptr=$(td,u.rows).closest("tr.jqgrow");if($(ptr).length===0){return}K=ptr[0].rowIndex;ci=$.jgrid.getCellIndex(td);$(u).triggerHandler("jqGridDblClickRow",[$(ptr).attr("id"),K,ci,e]);if($.isFunction(this.p.ondblClickRow)){u.p.ondblClickRow.call(u,$(ptr).attr("id"),K,ci,e)}}).bind('contextmenu',function(e){td=e.target;ptr=$(td,u.rows).closest("tr.jqgrow");if($(ptr).length===0){return}if(!u.p.multiselect){$(u).jqGrid("setSelection",ptr[0].id,true,e)}K=ptr[0].rowIndex;ci=$.jgrid.getCellIndex(td);$(u).triggerHandler("jqGridRightClickRow",[$(ptr).attr("id"),K,ci,e]);if($.isFunction(this.p.onRightClickRow)){u.p.onRightClickRow.call(u,$(ptr).attr("id"),K,ci,e)}});grid.bDiv=document.createElement("div");if(isMSIE){if(String(u.p.height).toLowerCase()==="auto"){u.p.height="100%"}}$(grid.bDiv).append($('<div style="position:relative;'+(isMSIE&&$.browser.version<8?"height:0.01%;":"")+'"></div>').append('<div></div>').append(this)).addClass("ui-jqgrid-bdiv").css({height:u.p.height+(isNaN(u.p.height)?"":"px"),width:(grid.width)+"px"}).scroll(grid.scrollGrid);$("table:first",grid.bDiv).css({width:u.p.tblwidth+"px"});if(isMSIE){if($("tbody",this).size()==2){$("tbody:gt(0)",this).remove()}if(u.p.multikey){$(grid.bDiv).bind("selectstart",function(){return false})}}else{if(u.p.multikey){$(grid.bDiv).bind("mousedown",function(){return false})}}if(hg){$(grid.bDiv).hide()}grid.cDiv=document.createElement("div");var L=u.p.hidegrid===true?$("<a role='link' href='javascript:void(0)'/>").addClass('ui-jqgrid-titlebar-close HeaderButton').hover(function(){L.addClass('ui-state-hover')},function(){L.removeClass('ui-state-hover')}).append("<span class='ui-icon ui-icon-circle-triangle-n'></span>").css((dir=="rtl"?"left":"right"),"0px"):"";$(grid.cDiv).append(L).append("<span class='ui-jqgrid-title"+(dir=="rtl"?"-rtl":"")+"'>"+u.p.caption+"</span>").addClass("ui-jqgrid-titlebar ui-widget-header ui-corner-top ui-helper-clearfix");$(grid.cDiv).insertBefore(grid.hDiv);if(u.p.toolbar[0]){grid.uDiv=document.createElement("div");if(u.p.toolbar[1]=="top"){$(grid.uDiv).insertBefore(grid.hDiv)}else if(u.p.toolbar[1]=="bottom"){$(grid.uDiv).insertAfter(grid.hDiv)}if(u.p.toolbar[1]=="both"){grid.ubDiv=document.createElement("div");$(grid.uDiv).insertBefore(grid.hDiv).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id);$(grid.ubDiv).insertAfter(grid.hDiv).addClass("ui-userdata ui-state-default").attr("id","tb_"+this.id);if(hg){$(grid.ubDiv).hide()}}else{$(grid.uDiv).width(grid.width).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id)}if(hg){$(grid.uDiv).hide()}}if(u.p.toppager){u.p.toppager=$.jgrid.jqID(u.p.id)+"_toppager";grid.topDiv=$("<div id='"+u.p.toppager+"'></div>")[0];u.p.toppager="#"+u.p.toppager;$(grid.topDiv).insertBefore(grid.hDiv).addClass('ui-state-default ui-jqgrid-toppager').width(grid.width);setPager(u.p.toppager,'_t')}if(u.p.footerrow){grid.sDiv=$("<div class='ui-jqgrid-sdiv'></div>")[0];hb=$("<div class='ui-jqgrid-hbox"+(dir=="rtl"?"-rtl":"")+"'></div>");$(grid.sDiv).append(hb).insertAfter(grid.hDiv).width(grid.width);$(hb).append(H);grid.footers=$(".ui-jqgrid-ftable",grid.sDiv)[0].rows[0].cells;if(u.p.rownumbers){grid.footers[0].className='ui-state-default jqgrid-rownum'}if(hg){$(grid.sDiv).hide()}}hb=null;if(u.p.caption){var M=u.p.datatype;if(u.p.hidegrid===true){$(".ui-jqgrid-titlebar-close",grid.cDiv).click(function(e){var a=$.isFunction(u.p.onHeaderClick),elems=".ui-jqgrid-bdiv, .ui-jqgrid-hdiv, .ui-jqgrid-pager, .ui-jqgrid-sdiv",counter,self=this;if(u.p.toolbar[0]===true){if(u.p.toolbar[1]=='both'){elems+=', #'+$(grid.ubDiv).attr('id')}elems+=', #'+$(grid.uDiv).attr('id')}counter=$(elems,"#gview_"+$.jgrid.jqID(u.p.id)).length;if(u.p.gridstate=='visible'){$(elems,"#gbox_"+$.jgrid.jqID(u.p.id)).slideUp("fast",function(){counter--;if(counter===0){$("span",self).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s");u.p.gridstate='hidden';if($("#gbox_"+$.jgrid.jqID(u.p.id)).hasClass("ui-resizable")){$(".ui-resizable-handle","#gbox_"+$.jgrid.jqID(u.p.id)).hide()}$(u).triggerHandler("jqGridHeaderClick",[u.p.gridstate,e]);if(a){if(!hg){u.p.onHeaderClick.call(u,u.p.gridstate,e)}}}})}else if(u.p.gridstate=='hidden'){$(elems,"#gbox_"+$.jgrid.jqID(u.p.id)).slideDown("fast",function(){counter--;if(counter===0){$("span",self).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n");if(hg){u.p.datatype=M;populate();hg=false}u.p.gridstate='visible';if($("#gbox_"+$.jgrid.jqID(u.p.id)).hasClass("ui-resizable")){$(".ui-resizable-handle","#gbox_"+$.jgrid.jqID(u.p.id)).show()}$(u).triggerHandler("jqGridHeaderClick",[u.p.gridstate,e]);if(a){if(!hg){u.p.onHeaderClick.call(u,u.p.gridstate,e)}}}})}return false});if(hg){u.p.datatype="local";$(".ui-jqgrid-titlebar-close",grid.cDiv).trigger("click")}}}else{$(grid.cDiv).hide()}$(grid.hDiv).after(grid.bDiv).mousemove(function(e){if(grid.resizing){grid.dragMove(e);return false}});$(".ui-jqgrid-labels",grid.hDiv).bind("selectstart",function(){return false});$(document).mouseup(function(){if(grid.resizing){grid.dragEnd();return false}return true});u.formatCol=formatCol;u.sortData=sortData;u.updatepager=updatepager;u.refreshIndex=refreshIndex;u.setHeadCheckBox=setHeadCheckBox;u.constructTr=constructTr;u.formatter=function(a,b,c,d,e){return formatter(a,b,c,d,e)};$.extend(grid,{populate:populate,emptyRows:emptyRows});this.grid=grid;u.addXmlData=function(d){addXmlData(d,u.grid.bDiv)};u.addJSONData=function(d){addJSONData(d,u.grid.bDiv)};this.grid.cols=this.rows[0].cells;populate();u.p.hiddengrid=false;$(window).unload(function(){u=null})})};$.jgrid.extend({getGridParam:function(a){var b=this[0];if(!b||!b.grid){return}if(!a){return b.p}else{return typeof(b.p[a])!="undefined"?b.p[a]:null}},setGridParam:function(a){return this.each(function(){if(this.grid&&typeof(a)==='object'){$.extend(true,this.p,a)}})},getDataIDs:function(){var a=[],i=0,len,j=0;this.each(function(){len=this.rows.length;if(len&&len>0){while(i<len){if($(this.rows[i]).hasClass('jqgrow')){a[j]=this.rows[i].id;j++}i++}}});return a},setSelection:function(d,f,e){return this.each(function(){var c=this,stat,pt,ner,ia,tpsr,fid;if(d===undefined){return}f=f===false?false:true;pt=c.rows.namedItem(d+"");if(!pt||!pt.className||pt.className.indexOf('ui-state-disabled')>-1){return}function scrGrid(a){var b=$(c.grid.bDiv)[0].clientHeight,st=$(c.grid.bDiv)[0].scrollTop,rpos=c.rows[a].offsetTop,rh=c.rows[a].clientHeight;if(rpos+rh>=b+st){$(c.grid.bDiv)[0].scrollTop=rpos-(b+st)+rh+st}else if(rpos<b+st){if(rpos<st){$(c.grid.bDiv)[0].scrollTop=rpos}}}if(c.p.scrollrows===true){ner=c.rows.namedItem(d).rowIndex;if(ner>=0){scrGrid(ner)}}if(c.p.frozenColumns===true){fid=c.p.id+"_frozen"}if(!c.p.multiselect){if(pt.className!=="ui-subgrid"){if(c.p.selrow!=pt.id){$(c.rows.namedItem(c.p.selrow)).removeClass("ui-state-highlight").attr({"aria-selected":"false","tabindex":"-1"});$(pt).addClass("ui-state-highlight").attr({"aria-selected":"true","tabindex":"0"});if(fid){$("#"+$.jgrid.jqID(c.p.selrow),"#"+$.jgrid.jqID(fid)).removeClass("ui-state-highlight");$("#"+$.jgrid.jqID(d),"#"+$.jgrid.jqID(fid)).addClass("ui-state-highlight")}stat=true}else{stat=false}c.p.selrow=pt.id;$(c).triggerHandler("jqGridSelectRow",[pt.id,stat,e]);if(c.p.onSelectRow&&f){c.p.onSelectRow.call(c,pt.id,stat,e)}}}else{c.setHeadCheckBox(false);c.p.selrow=pt.id;ia=$.inArray(c.p.selrow,c.p.selarrrow);if(ia===-1){if(pt.className!=="ui-subgrid"){$(pt).addClass("ui-state-highlight").attr("aria-selected","true")}stat=true;c.p.selarrrow.push(c.p.selrow)}else{if(pt.className!=="ui-subgrid"){$(pt).removeClass("ui-state-highlight").attr("aria-selected","false")}stat=false;c.p.selarrrow.splice(ia,1);tpsr=c.p.selarrrow[0];c.p.selrow=(tpsr===undefined)?null:tpsr}$("#jqg_"+$.jgrid.jqID(c.p.id)+"_"+$.jgrid.jqID(pt.id))[c.p.useProp?'prop':'attr']("checked",stat);if(fid){if(ia===-1){$("#"+$.jgrid.jqID(d),"#"+$.jgrid.jqID(fid)).addClass("ui-state-highlight")}else{$("#"+$.jgrid.jqID(d),"#"+$.jgrid.jqID(fid)).removeClass("ui-state-highlight")}$("#jqg_"+$.jgrid.jqID(c.p.id)+"_"+$.jgrid.jqID(d),"#"+$.jgrid.jqID(fid))[c.p.useProp?'prop':'attr']("checked",stat)}$(c).triggerHandler("jqGridSelectRow",[pt.id,stat,e]);if(c.p.onSelectRow&&f){c.p.onSelectRow.call(c,pt.id,stat,e)}}})},resetSelection:function(a){return this.each(function(){var t=this,ind,sr,fid;if(t.p.frozenColumns===true){fid=t.p.id+"_frozen"}if(typeof(a)!=="undefined"){sr=a===t.p.selrow?t.p.selrow:a;$("#"+$.jgrid.jqID(t.p.id)+" tbody:first tr#"+$.jgrid.jqID(sr)).removeClass("ui-state-highlight").attr("aria-selected","false");if(fid){$("#"+$.jgrid.jqID(sr),"#"+$.jgrid.jqID(fid)).removeClass("ui-state-highlight")}if(t.p.multiselect){$("#jqg_"+$.jgrid.jqID(t.p.id)+"_"+$.jgrid.jqID(sr),"#"+$.jgrid.jqID(t.p.id))[t.p.useProp?'prop':'attr']("checked",false);if(fid){$("#jqg_"+$.jgrid.jqID(t.p.id)+"_"+$.jgrid.jqID(sr),"#"+$.jgrid.jqID(fid))[t.p.useProp?'prop':'attr']("checked",false)}t.setHeadCheckBox(false)}sr=null}else if(!t.p.multiselect){if(t.p.selrow){$("#"+$.jgrid.jqID(t.p.id)+" tbody:first tr#"+$.jgrid.jqID(t.p.selrow)).removeClass("ui-state-highlight").attr("aria-selected","false");if(fid){$("#"+$.jgrid.jqID(t.p.selrow),"#"+$.jgrid.jqID(fid)).removeClass("ui-state-highlight")}t.p.selrow=null}}else{$(t.p.selarrrow).each(function(i,n){ind=t.rows.namedItem(n);$(ind).removeClass("ui-state-highlight").attr("aria-selected","false");$("#jqg_"+$.jgrid.jqID(t.p.id)+"_"+$.jgrid.jqID(n))[t.p.useProp?'prop':'attr']("checked",false);if(fid){$("#"+$.jgrid.jqID(n),"#"+$.jgrid.jqID(fid)).removeClass("ui-state-highlight");$("#jqg_"+$.jgrid.jqID(t.p.id)+"_"+$.jgrid.jqID(n),"#"+$.jgrid.jqID(fid))[t.p.useProp?'prop':'attr']("checked",false)}});t.setHeadCheckBox(false);t.p.selarrrow=[]}if(t.p.cellEdit===true){if(parseInt(t.p.iCol,10)>=0&&parseInt(t.p.iRow,10)>=0){$("td:eq("+t.p.iCol+")",t.rows[t.p.iRow]).removeClass("edit-cell ui-state-highlight");$(t.rows[t.p.iRow]).removeClass("selected-row ui-state-hover")}}t.p.savedRow=[]})},getRowData:function(b){var c={},resall,getall=false,len,j=0;this.each(function(){var a=this,nm,ind;if(typeof(b)=='undefined'){getall=true;resall=[];len=a.rows.length}else{ind=a.rows.namedItem(b);if(!ind){return c}len=2}while(j<len){if(getall){ind=a.rows[j]}if($(ind).hasClass('jqgrow')){$('td[role="gridcell"]',ind).each(function(i){nm=a.p.colModel[i].name;if(nm!=='cb'&&nm!=='subgrid'&&nm!=='rn'){if(a.p.treeGrid===true&&nm==a.p.ExpandColumn){c[nm]=$.jgrid.htmlDecode($("span:first",this).html())}else{try{c[nm]=$.unformat.call(a,this,{rowId:ind.id,colModel:a.p.colModel[i]},i)}catch(e){c[nm]=$.jgrid.htmlDecode($(this).html())}}}});if(getall){resall.push(c);c={}}}j++}});return resall?resall:c},delRowData:function(d){var e=false,rowInd,ia,ri;this.each(function(){var a=this;rowInd=a.rows.namedItem(d);if(!rowInd){return false}else{ri=rowInd.rowIndex;$(rowInd).remove();a.p.records--;a.p.reccount--;a.updatepager(true,false);e=true;if(a.p.multiselect){ia=$.inArray(d,a.p.selarrrow);if(ia!=-1){a.p.selarrrow.splice(ia,1)}}if(d==a.p.selrow){a.p.selrow=null}}if(a.p.datatype=='local'){var b=$.jgrid.stripPref(a.p.idPrefix,d),pos=a.p._index[b];if(typeof(pos)!='undefined'){a.p.data.splice(pos,1);a.refreshIndex()}}if(a.p.altRows===true&&e){var c=a.p.altclass;$(a.rows).each(function(i){if(i%2==1){$(this).addClass(c)}else{$(this).removeClass(c)}})}});return e},setRowData:function(c,d,f){var g,success=true,title;this.each(function(){if(!this.grid){return false}var t=this,vl,ind,cp=typeof f,lcdata={};ind=t.rows.namedItem(c);if(!ind){return false}if(d){try{$(this.p.colModel).each(function(i){g=this.name;if(d[g]!==undefined){lcdata[g]=this.formatter&&typeof(this.formatter)==='string'&&this.formatter=='date'?$.unformat.date.call(t,d[g],this):d[g];vl=t.formatter(c,d[g],i,d,'edit');title=this.title?{"title":$.jgrid.stripHtml(vl)}:{};if(t.p.treeGrid===true&&g==t.p.ExpandColumn){$("td:eq("+i+") > span:first",ind).html(vl).attr(title)}else{$("td:eq("+i+")",ind).html(vl).attr(title)}}});if(t.p.datatype=='local'){var a=$.jgrid.stripPref(t.p.idPrefix,c),pos=t.p._index[a];if(t.p.treeGrid){for(var b in t.p.treeReader){if(lcdata.hasOwnProperty(t.p.treeReader[b])){delete lcdata[t.p.treeReader[b]]}}}if(typeof(pos)!='undefined'){t.p.data[pos]=$.extend(true,t.p.data[pos],lcdata)}lcdata=null}}catch(e){success=false}}if(success){if(cp==='string'){$(ind).addClass(f)}else if(cp==='object'){$(ind).css(f)}$(t).triggerHandler("jqGridAfterGridComplete")}});return success},addRowData:function(a,b,c,d){if(!c){c="last"}var f=false,nm,row,gi,si,ni,sind,i,v,prp="",aradd,cnm,cn,data,cm,id;if(b){if($.isArray(b)){aradd=true;c="last";cnm=a}else{b=[b];aradd=false}this.each(function(){var t=this,datalen=b.length;ni=t.p.rownumbers===true?1:0;gi=t.p.multiselect===true?1:0;si=t.p.subGrid===true?1:0;if(!aradd){if(typeof(a)!='undefined'){a=a+""}else{a=$.jgrid.randId();if(t.p.keyIndex!==false){cnm=t.p.colModel[t.p.keyIndex+gi+si+ni].name;if(typeof b[0][cnm]!="undefined"){a=b[0][cnm]}}}}cn=t.p.altclass;var k=0,cna="",lcdata={},air=$.isFunction(t.p.afterInsertRow)?true:false;while(k<datalen){data=b[k];row=[];if(aradd){try{a=data[cnm]}catch(e){a=$.jgrid.randId()}cna=t.p.altRows===true?(t.rows.length-1)%2===0?cn:"":""}id=a;a=t.p.idPrefix+a;if(ni){prp=t.formatCol(0,1,'',null,a,true);row[row.length]="<td role=\"gridcell\" class=\"ui-state-default jqgrid-rownum\" "+prp+">0</td>"}if(gi){v="<input role=\"checkbox\" type=\"checkbox\""+" id=\"jqg_"+t.p.id+"_"+a+"\" class=\"cbox\"/>";prp=t.formatCol(ni,1,'',null,a,true);row[row.length]="<td role=\"gridcell\" "+prp+">"+v+"</td>"}if(si){row[row.length]=$(t).jqGrid("addSubGridCell",gi+ni,1)}for(i=gi+si+ni;i<t.p.colModel.length;i++){cm=t.p.colModel[i];nm=cm.name;lcdata[nm]=data[nm];v=t.formatter(a,$.jgrid.getAccessor(data,nm),i,data);prp=t.formatCol(i,1,v,data,a,true);row[row.length]="<td role=\"gridcell\" "+prp+">"+v+"</td>"}row.unshift(t.constructTr(a,false,cna,lcdata,lcdata));row[row.length]="</tr>";if(t.rows.length===0){$("table:first",t.grid.bDiv).append(row.join(''))}else{switch(c){case'last':$(t.rows[t.rows.length-1]).after(row.join(''));sind=t.rows.length-1;break;case'first':$(t.rows[0]).after(row.join(''));sind=1;break;case'after':sind=t.rows.namedItem(d);if(sind){if($(t.rows[sind.rowIndex+1]).hasClass("ui-subgrid")){$(t.rows[sind.rowIndex+1]).after(row)}else{$(sind).after(row.join(''))}}sind++;break;case'before':sind=t.rows.namedItem(d);if(sind){$(sind).before(row.join(''));sind=sind.rowIndex}sind--;break}}if(t.p.subGrid===true){$(t).jqGrid("addSubGrid",gi+ni,sind)}t.p.records++;t.p.reccount++;$(t).triggerHandler("jqGridAfterInsertRow",[a,data,data]);if(air){t.p.afterInsertRow.call(t,a,data,data)}k++;if(t.p.datatype=='local'){lcdata[t.p.localReader.id]=id;t.p._index[id]=t.p.data.length;t.p.data.push(lcdata);lcdata={}}}if(t.p.altRows===true&&!aradd){if(c=="last"){if((t.rows.length-1)%2==1){$(t.rows[t.rows.length-1]).addClass(cn)}}else{$(t.rows).each(function(i){if(i%2==1){$(this).addClass(cn)}else{$(this).removeClass(cn)}})}}t.updatepager(true,true);f=true})}return f},footerData:function(b,c,d){var e,success=false,res={},title;function isEmpty(a){for(var i in a){if(a.hasOwnProperty(i)){return false}}return true}if(typeof(b)=="undefined"){b="get"}if(typeof(d)!="boolean"){d=true}b=b.toLowerCase();this.each(function(){var t=this,vl;if(!t.grid||!t.p.footerrow){return false}if(b=="set"){if(isEmpty(c)){return false}}success=true;$(this.p.colModel).each(function(i){e=this.name;if(b=="set"){if(c[e]!==undefined){vl=d?t.formatter("",c[e],i,c,'edit'):c[e];title=this.title?{"title":$.jgrid.stripHtml(vl)}:{};$("tr.footrow td:eq("+i+")",t.grid.sDiv).html(vl).attr(title);success=true}}else if(b=="get"){res[e]=$("tr.footrow td:eq("+i+")",t.grid.sDiv).html()}})});return b=="get"?res:success},showHideCol:function(c,d){return this.each(function(){var a=this,fndh=false,brd=$.jgrid.cellWidth()?0:a.p.cellLayout,cw;if(!a.grid){return}if(typeof c==='string'){c=[c]}d=d!="none"?"":"none";var b=d===""?true:false,gh=a.p.groupHeader&&(typeof a.p.groupHeader==='object'||$.isFunction(a.p.groupHeader));if(gh){$(a).jqGrid('destroyGroupHeader',false)}$(this.p.colModel).each(function(i){if($.inArray(this.name,c)!==-1&&this.hidden===b){if(a.p.frozenColumns===true&&this.frozen===true){return true}$("tr",a.grid.hDiv).each(function(){$(this.cells[i]).css("display",d)});$(a.rows).each(function(){if(!$(this).hasClass("jqgroup")){$(this.cells[i]).css("display",d)}});if(a.p.footerrow){$("tr.footrow td:eq("+i+")",a.grid.sDiv).css("display",d)}cw=parseInt(this.width,10);if(d==="none"){a.p.tblwidth-=cw+brd}else{a.p.tblwidth+=cw+brd}this.hidden=!b;fndh=true;$(a).triggerHandler("jqGridShowHideCol",[b,this.name,i])}});if(fndh===true){if(a.p.shrinkToFit===true&&!isNaN(a.p.height)){a.p.tblwidth+=parseInt(a.p.scrollOffset,10)}$(a).jqGrid("setGridWidth",a.p.shrinkToFit===true?a.p.tblwidth:a.p.width)}if(gh){$(a).jqGrid('setGroupHeaders',a.p.groupHeader)}})},hideCol:function(a){return this.each(function(){$(this).jqGrid("showHideCol",a,"none")})},showCol:function(a){return this.each(function(){$(this).jqGrid("showHideCol",a,"")})},remapColumns:function(f,g,h){function resortArray(a){var b;if(a.length){b=$.makeArray(a)}else{b=$.extend({},a)}$.each(f,function(i){a[i]=b[this]})}var j=this.get(0);function resortRows(c,d){$(">tr"+(d||""),c).each(function(){var a=this;var b=$.makeArray(a.cells);$.each(f,function(){var e=b[this];if(e){a.appendChild(e)}})})}resortArray(j.p.colModel);resortArray(j.p.colNames);resortArray(j.grid.headers);resortRows($("thead:first",j.grid.hDiv),h&&":not(.ui-jqgrid-labels)");if(g){resortRows($("#"+$.jgrid.jqID(j.p.id)+" tbody:first"),".jqgfirstrow, tr.jqgrow, tr.jqfoot")}if(j.p.footerrow){resortRows($("tbody:first",j.grid.sDiv))}if(j.p.remapColumns){if(!j.p.remapColumns.length){j.p.remapColumns=$.makeArray(f)}else{resortArray(j.p.remapColumns)}}j.p.lastsort=$.inArray(j.p.lastsort,f);if(j.p.treeGrid){j.p.expColInd=$.inArray(j.p.expColInd,f)}$(j).triggerHandler("jqGridRemapColumns",[f,g,h])},setGridWidth:function(d,e){return this.each(function(){if(!this.grid){return}var a=this,cw,initwidth=0,brd=$.jgrid.cellWidth()?0:a.p.cellLayout,lvc,vc=0,hs=false,scw=a.p.scrollOffset,aw,gw=0,cl=0,cr;if(typeof e!='boolean'){e=a.p.shrinkToFit}if(isNaN(d)){return}d=parseInt(d,10);a.grid.width=a.p.width=d;$("#gbox_"+$.jgrid.jqID(a.p.id)).css("width",d+"px");$("#gview_"+$.jgrid.jqID(a.p.id)).css("width",d+"px");$(a.grid.bDiv).css("width",d+"px");$(a.grid.hDiv).css("width",d+"px");if(a.p.pager){$(a.p.pager).css("width",d+"px")}if(a.p.toppager){$(a.p.toppager).css("width",d+"px")}if(a.p.toolbar[0]===true){$(a.grid.uDiv).css("width",d+"px");if(a.p.toolbar[1]=="both"){$(a.grid.ubDiv).css("width",d+"px")}}if(a.p.footerrow){$(a.grid.sDiv).css("width",d+"px")}if(e===false&&a.p.forceFit===true){a.p.forceFit=false}if(e===true){$.each(a.p.colModel,function(){if(this.hidden===false){cw=this.widthOrg;initwidth+=cw+brd;if(this.fixed){gw+=cw+brd}else{vc++}cl++}});if(vc===0){return}a.p.tblwidth=initwidth;aw=d-brd*vc-gw;if(!isNaN(a.p.height)){if($(a.grid.bDiv)[0].clientHeight<$(a.grid.bDiv)[0].scrollHeight||a.rows.length===1){hs=true;aw-=scw}}initwidth=0;var b=a.grid.cols.length>0;$.each(a.p.colModel,function(i){if(this.hidden===false&&!this.fixed){cw=this.widthOrg;cw=Math.round(aw*cw/(a.p.tblwidth-brd*vc-gw));if(cw<0){return}this.width=cw;initwidth+=cw;a.grid.headers[i].width=cw;a.grid.headers[i].el.style.width=cw+"px";if(a.p.footerrow){a.grid.footers[i].style.width=cw+"px"}if(b){a.grid.cols[i].style.width=cw+"px"}lvc=i}});if(!lvc){return}cr=0;if(hs){if(d-gw-(initwidth+brd*vc)!==scw){cr=d-gw-(initwidth+brd*vc)-scw}}else if(Math.abs(d-gw-(initwidth+brd*vc))!==1){cr=d-gw-(initwidth+brd*vc)}a.p.colModel[lvc].width+=cr;a.p.tblwidth=initwidth+cr+brd*vc+gw;if(a.p.tblwidth>d){var c=a.p.tblwidth-parseInt(d,10);a.p.tblwidth=d;cw=a.p.colModel[lvc].width=a.p.colModel[lvc].width-c}else{cw=a.p.colModel[lvc].width}a.grid.headers[lvc].width=cw;a.grid.headers[lvc].el.style.width=cw+"px";if(b){a.grid.cols[lvc].style.width=cw+"px"}if(a.p.footerrow){a.grid.footers[lvc].style.width=cw+"px"}}if(a.p.tblwidth){$('table:first',a.grid.bDiv).css("width",a.p.tblwidth+"px");$('table:first',a.grid.hDiv).css("width",a.p.tblwidth+"px");a.grid.hDiv.scrollLeft=a.grid.bDiv.scrollLeft;if(a.p.footerrow){$('table:first',a.grid.sDiv).css("width",a.p.tblwidth+"px")}}})},setGridHeight:function(c){return this.each(function(){var a=this;if(!a.grid){return}var b=$(a.grid.bDiv);b.css({height:c+(isNaN(c)?"":"px")});if(a.p.frozenColumns===true){$('#'+$.jgrid.jqID(a.p.id)+"_frozen").parent().height(b.height()-16)}a.p.height=c;if(a.p.scroll){a.grid.populateVisible()}})},setCaption:function(a){return this.each(function(){this.p.caption=a;$("span.ui-jqgrid-title, span.ui-jqgrid-title-rtl",this.grid.cDiv).html(a);$(this.grid.cDiv).show()})},setLabel:function(d,e,f,g){return this.each(function(){var a=this,pos=-1;if(!a.grid){return}if(typeof(d)!="undefined"){$(a.p.colModel).each(function(i){if(this.name==d){pos=i;return false}})}else{return}if(pos>=0){var b=$("tr.ui-jqgrid-labels th:eq("+pos+")",a.grid.hDiv);if(e){var c=$(".s-ico",b);$("[id^=jqgh_]",b).empty().html(e).append(c);a.p.colNames[pos]=e}if(f){if(typeof f==='string'){$(b).addClass(f)}else{$(b).css(f)}}if(typeof g==='object'){$(b).attr(g)}}})},setCell:function(e,f,g,h,j,k){return this.each(function(){var a=this,pos=-1,v,title;if(!a.grid){return}if(isNaN(f)){$(a.p.colModel).each(function(i){if(this.name==f){pos=i;return false}})}else{pos=parseInt(f,10)}if(pos>=0){var b=a.rows.namedItem(e);if(b){var c=$("td:eq("+pos+")",b);if(g!==""||k===true){v=a.formatter(e,g,pos,b,'edit');title=a.p.colModel[pos].title?{"title":$.jgrid.stripHtml(v)}:{};if(a.p.treeGrid&&$(".tree-wrap",$(c)).length>0){$("span",$(c)).html(v).attr(title)}else{$(c).html(v).attr(title)}if(a.p.datatype=="local"){var d=a.p.colModel[pos],index;g=d.formatter&&typeof(d.formatter)==='string'&&d.formatter=='date'?$.unformat.date.call(a,g,d):g;index=a.p._index[e];if(typeof index!="undefined"){a.p.data[index][d.name]=g}}}if(typeof h==='string'){$(c).addClass(h)}else if(h){$(c).css(h)}if(typeof j==='object'){$(c).attr(j)}}}})},getCell:function(c,d){var f=false;this.each(function(){var a=this,pos=-1;if(!a.grid){return}if(isNaN(d)){$(a.p.colModel).each(function(i){if(this.name===d){pos=i;return false}})}else{pos=parseInt(d,10)}if(pos>=0){var b=a.rows.namedItem(c);if(b){try{f=$.unformat.call(a,$("td:eq("+pos+")",b),{rowId:b.id,colModel:a.p.colModel[pos]},pos)}catch(e){f=$.jgrid.htmlDecode($("td:eq("+pos+")",b).html())}}}});return f},getCol:function(c,d,f){var g=[],val,sum=0,min,max,v;d=typeof(d)!='boolean'?false:d;if(typeof f=='undefined'){f=false}this.each(function(){var a=this,pos=-1;if(!a.grid){return}if(isNaN(c)){$(a.p.colModel).each(function(i){if(this.name===c){pos=i;return false}})}else{pos=parseInt(c,10)}if(pos>=0){var b=a.rows.length,i=0;if(b&&b>0){while(i<b){if($(a.rows[i]).hasClass('jqgrow')){try{val=$.unformat.call(a,$(a.rows[i].cells[pos]),{rowId:a.rows[i].id,colModel:a.p.colModel[pos]},pos)}catch(e){val=$.jgrid.htmlDecode(a.rows[i].cells[pos].innerHTML)}if(f){v=parseFloat(val);sum+=v;if(i===0){min=v;max=v}else{min=Math.min(min,v);max=Math.max(max,v)}}else if(d){g.push({id:a.rows[i].id,value:val})}else{g.push(val)}}i++}if(f){switch(f.toLowerCase()){case'sum':g=sum;break;case'avg':g=sum/b;break;case'count':g=b;break;case'min':g=min;break;case'max':g=max;break}}}}});return g},clearGridData:function(c){return this.each(function(){var a=this;if(!a.grid){return}if(typeof c!='boolean'){c=false}if(a.p.deepempty){$("#"+$.jgrid.jqID(a.p.id)+" tbody:first tr:gt(0)").remove()}else{var b=$("#"+$.jgrid.jqID(a.p.id)+" tbody:first tr:first")[0];$("#"+$.jgrid.jqID(a.p.id)+" tbody:first").empty().append(b)}if(a.p.footerrow&&c){$(".ui-jqgrid-ftable td",a.grid.sDiv).html("&#160;")}a.p.selrow=null;a.p.selarrrow=[];a.p.savedRow=[];a.p.records=0;a.p.page=1;a.p.lastpage=0;a.p.reccount=0;a.p.data=[];a.p._index={};a.updatepager(true,false)})},getInd:function(a,b){var c=false,rw;this.each(function(){rw=this.rows.namedItem(a);if(rw){c=b===true?rw:rw.rowIndex}});return c},bindKeys:function(d){var o=$.extend({onEnter:null,onSpace:null,onLeftKey:null,onRightKey:null,scrollingRows:true},d||{});return this.each(function(){var c=this;if(!$('body').is('[role]')){$('body').attr('role','application')}c.p.scrollrows=o.scrollingRows;$(c).keydown(function(a){var b=$(c).find('tr[tabindex=0]')[0],id,r,mind,expanded=c.p.treeReader.expanded_field;if(b){mind=c.p._index[b.id];if(a.keyCode===37||a.keyCode===38||a.keyCode===39||a.keyCode===40){if(a.keyCode===38){r=b.previousSibling;id="";if(r){if($(r).is(":hidden")){while(r){r=r.previousSibling;if(!$(r).is(":hidden")&&$(r).hasClass('jqgrow')){id=r.id;break}}}else{id=r.id}}$(c).jqGrid('setSelection',id,true,a)}if(a.keyCode===40){r=b.nextSibling;id="";if(r){if($(r).is(":hidden")){while(r){r=r.nextSibling;if(!$(r).is(":hidden")&&$(r).hasClass('jqgrow')){id=r.id;break}}}else{id=r.id}}$(c).jqGrid('setSelection',id,true,a)}if(a.keyCode===37){if(c.p.treeGrid&&c.p.data[mind][expanded]){$(b).find("div.treeclick").trigger('click')}$(c).triggerHandler("jqGridKeyLeft",[c.p.selrow]);if($.isFunction(o.onLeftKey)){o.onLeftKey.call(c,c.p.selrow)}}if(a.keyCode===39){if(c.p.treeGrid&&!c.p.data[mind][expanded]){$(b).find("div.treeclick").trigger('click')}$(c).triggerHandler("jqGridKeyRight",[c.p.selrow]);if($.isFunction(o.onRightKey)){o.onRightKey.call(c,c.p.selrow)}}}else if(a.keyCode===13){$(c).triggerHandler("jqGridKeyEnter",[c.p.selrow]);if($.isFunction(o.onEnter)){o.onEnter.call(c,c.p.selrow)}}else if(a.keyCode===32){$(c).triggerHandler("jqGridKeySpace",[c.p.selrow]);if($.isFunction(o.onSpace)){o.onSpace.call(c,c.p.selrow)}}}})})},unbindKeys:function(){return this.each(function(){$(this).unbind('keydown')})},getLocalRow:function(a){var b=false,ind;this.each(function(){if(typeof(a)!=="undefined"){ind=this.p._index[a];if(ind>=0){b=this.p.data[ind]}}});return b}})})(jQuery);
