(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{635:function(e,t,a){},660:function(e,t,a){"use strict";a.r(t);a(150);var l=a(8),n=(a(296),a(71)),s=(a(52),a(10)),r=(a(94),a(22)),i=(a(200),a(21)),o=a(95),c=a(11),u=a(23),m=a(24),d=a(29),h=a(28),p=a(30),f=a(63),b=a(0),w=a.n(b),v=a(96),g=(a(622),a(199),a(84),a(47)),y=a(280),E=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).owner=a.props.owner,a.state={visible:!0},a.excelRef=w.a.createRef(),a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"handleOk",value:function(){var e=this;this.getWorkbook();for(var t=this.excelRef.current.excel,a=t.getSettings(),l=a.maxCols,n=a.maxRows;n>0&&t.isEmptyRow(n-1);)--n;for(;l>0&&t.isEmptyCol(l-1);)--l;var s=[];t.getPlugin("mergeCells").mergedCellsCollection.mergedCells.map(function(e){e.removed||s.push({row:e.row,col:e.col,rowspan:e.rowspan,colspan:e.colspan})});var r={},i=1;t.updateSettings({viewportRowRenderingOffset:n,viewportColumnRenderingOffset:l,mergeCells:s});for(var o=0;o<l;o++)for(var c=[],u=0,m=0;m<n;m++){var d=t.getCell(m,o),h=t.getCoords(d),p=t.getDataAtCell(h.row,h.col);if(null===p&&(p=""),m===h.row&&""!==p){u++;var f=t.getCellMeta(h.row,h.col);c.push({name:p,style:f.def.styleName})}""!==p&&h.col===o&&m===n-1&&(r[p]={columns:c,width:t.getColWidth(o)},i<u&&(i=u))}this.handleCancel(),window.setTimeout(function(){return e.owner.setSubFieldLayout(r,i)},0)}},{key:"handleCancel",value:function(){var e=this;window.setTimeout(function(){return e.owner.setState({listHeaderPropsShowFlag:!1})},0)}},{key:"render",value:function(){return w.a.createElement("div",null,w.a.createElement(g.a,{title:"\u8bbe\u8ba1\u5217\u8868\u5934",visible:this.state.visible,onOk:this.handleOk.bind(this),onCancel:this.handleCancel.bind(this),footer:[w.a.createElement(s.a,{key:"back",type:"ghost",size:"large",onClick:this.handleCancel.bind(this)},"\u53d6 \u6d88"),w.a.createElement(s.a,{key:"submit",type:"primary",size:"large",onClick:this.handleOk.bind(this)},"\u63d0 \u4ea4")],width:"915px",style:{top:"20px"},maskClosable:!1},w.a.createElement("div",{style:{height:"400px",overflow:"hidden"}},w.a.createElement(y.a,{ref:this.excelRef,single:!0,owner:this,items:this.props.items}))))}},{key:"componentDidMount",value:function(){var e=this;window.setTimeout(function(){var t=e.props,a=t.level,l=t.subFields,n=e.excelRef.current.excel;if(l){var s=[],r=[];l.map(function(e,t){e.layout||(e.layout={columns:[]},e.layout.columns.push({name:e.title})),e.layout&&(e.layout.width&&s.push(e.layout.width),e.layout.columns.map(function(a,l){if(n.setDataAtCell(l,t,l===e.layout.columns.length-1?e.title:a.name),a.style){var s=n.getCellMeta(l,t);s.def||(s.def={}),s.def.styleName=a.style,n.setCellMetaObject(l,t,s)}}))}),s.length>0&&n.updateSettings({colWidths:s});for(var i=0;i<a;i++){for(var o=0,c="",u=0;u<l.length;){var m=n.getDataAtCell(i,u);null===m&&(m=""),""!==c&&c!==m&&(r.push({row:i,col:o,rowspan:1,colspan:u-o}),c=""),""===c&&(c=m,o=u),u++}""!==c&&r.push({row:i,col:o,rowspan:1,colspan:u-o})}for(var d=0;d<l.length;d++)for(var h=a-1;h>=0;h--){var p=n.getDataAtCell(h,d);if(null===p&&(p=""),""!==p){h<a-1&&r.push({row:h,col:d,rowspan:a-h,colspan:1});break}}r.length>0&&n.updateSettings({mergeCells:r})}},50)}}]),t}(b.Component),C=(a(635),a(2)),k=a.n(C),S=(a(637),function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).owner=a.props.owner,a.state={ischanged:!1,exprShowFlag:!1,outLinkShowFlag:!1,listHeaderPropsShowFlag:!1,name:"",title:"\u5217\u8868",desc:"",defaultType:"custom",defaultValue:"",required:!1,noDup:!1,readonly:!1,hidden:!1,asTitle:!1,isSearch:!1,link:"",type:"list",subFields:[],defaultRows:1,headLevel:1,autoSize:!1},a.state=Object(c.a)({},a.state,a.props.def),a.owner.comfirmControlProp=a.comfirmControlProp.bind(Object(f.a)(Object(f.a)(a))),a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"comfirmControlProp",value:function(){if(this.state.ischanged){this.setState({ischanged:!1});var e=Object(c.a)({},this.state);delete e.ischanged,delete e.exprShowFlag,delete e.outLinkShowFlag,delete e.listHeaderPropsShowFlag,this.owner.sysCurCellMeta(e)}}},{key:"setControlProp",value:function(e,t){var a;"title"===e?this.setState((a={},Object(o.a)(a,e,t),Object(o.a)(a,"name",t),a)):this.setState(Object(o.a)({},e,t));this.setState({ischanged:!0})}},{key:"addSubField",value:function(e){var t=this,a=this.state.subFields,l=v.a.filter(function(t){return t.name===e.key});a.push({title:l[0].label,type:e.key}),this.setState({subFields:a}),window.setTimeout(function(){var e=Object(c.a)({},t.state);delete e.ischanged,delete e.exprShowFlag,delete e.outLinkShowFlag,delete e.listHeaderPropsShowFlag,t.owner.sysCurCellMeta(e)},0)}},{key:"setSubField",value:function(e,t){this.owner.setState({curSubField:e,curSubFieldIndex:t})}},{key:"deleteSubField",value:function(e){var t=this;if(window.confirm("\u786e\u5b9a\u8981\u5220\u9664\u8be5\u5b57\u6bb5\u5417\uff1f")){var a=this.state.subFields;a&&(a=a.filter(function(t,a){return e!==a}),this.setState({subFields:a}),window.setTimeout(function(){var e=Object(c.a)({},t.state);delete e.ischanged,delete e.exprShowFlag,delete e.outLinkShowFlag,delete e.listHeaderPropsShowFlag,t.owner.sysCurCellMeta(e)},0))}}},{key:"setSubFieldLayout",value:function(e,t){var a=this,l=this.state.subFields;l&&l.map(function(t){t.layout=e[t.title],t.layout.columns[t.layout.columns.length-1].name=t.alias&&""!==t.alias?t.alias:t.title}),this.setState({subFields:l,headLevel:t}),window.setTimeout(function(){var e=Object(c.a)({},a.state);delete e.ischanged,delete e.exprShowFlag,delete e.outLinkShowFlag,delete e.listHeaderPropsShowFlag,a.owner.sysCurCellMeta(e)},0)}},{key:"render",value:function(){var e=this,t=v.b.filter(function(t){return t.name===e.state.type}),a=v.a.filter(function(t){return t.name===e.state.type}),o=(Object.keys(this.props.columnsOfForm).map(function(t){return e.props.columnsOfForm[t]}),this.props.parent_list,w.a.createElement(i.a,{onClick:this.addSubField.bind(this)},v.a.map(function(e){return"autoNumber"!=e.name&&"list"!=e.name&&"signature"!=e.name&&w.a.createElement(i.a.Item,{key:e.name},e.label)})));this.state.defaultValue,this.props.formId;return w.a.createElement("div",{className:"config-panel list-panel "},w.a.createElement("div",{className:"ant-row ant-form-item"},w.a.createElement("div",{className:"ant-form-item-label"},w.a.createElement("label",null,"\u540d\u79f0")),w.a.createElement("div",{className:"ant-form-item-control has-success"},w.a.createElement("span",{className:"ant-input-wrapper"},w.a.createElement("input",{type:"text",placeholder:"\u8bf7\u8f93\u5165\u63a7\u4ef6\u540d\u79f0",className:"config-text-len ant-input",value:this.state.title,onChange:function(t){return e.setControlProp("title",t.target.value)}})))),w.a.createElement("div",{className:"ant-row ant-form-item"},w.a.createElement("div",{className:"ant-form-item-label"},w.a.createElement("label",null,"\u63a7\u4ef6\u7c7b\u578b"),w.a.createElement("span",{className:"ant-input-wrapper config-typename"},t&&t.length>0?w.a.createElement(r.a,{value:[this.state.type],onChange:function(t){return e.setControlProp("type",t)},size:"small",style:{width:"120px"}},v.b.map(function(e){return w.a.createElement(r.a.Option,{value:e.name,key:e.name},e.label)})):w.a.createElement("span",{className:"ant-input-wrapper config-typename"},a[0].label)))),w.a.createElement("div",{className:"ant-row ant-form-item"},w.a.createElement("div",{className:"ant-form-item-label"},w.a.createElement("label",null,"\u63cf\u8ff0")),w.a.createElement("div",{className:"ant-form-item-control has-success"},w.a.createElement("span",{className:"ant-input-wrapper"},w.a.createElement("textarea",{type:"textarea",placeholder:"\u8bf7\u8f93\u5165\u63a7\u4ef6\u63cf\u8ff0",className:"config-text-desc ant-input",value:this.state.desc,onChange:function(t){return e.setControlProp("desc",t.target.value)}})))),w.a.createElement("div",{className:"ant-row ant-form-item"},w.a.createElement("div",{className:"ant-form-item-label"},w.a.createElement("label",null,"\u5b57\u6bb5")),w.a.createElement("div",{className:"ant-form-item-control has-success"},w.a.createElement(n.a,{overlay:o},w.a.createElement(s.a,null,"\u6dfb\u52a0\u5b57\u6bb5")),w.a.createElement(s.a,{onClick:function(){return e.setState({listHeaderPropsShowFlag:!0})}},"\u8bbe\u8ba1\u8868\u5934"),this.state.listHeaderPropsShowFlag?w.a.createElement(E,{owner:this,level:this.state.headLevel,subFields:this.state.subFields,items:this.props.columnsOfForm}):null,w.a.createElement("ul",{className:"sub-fields",id:"sortable"},this.state.subFields?this.state.subFields.map(function(t,a){return w.a.createElement("li",{key:a,fieldIndex:a},w.a.createElement("p",{onClick:e.setSubField.bind(e,t,a)},t.title),w.a.createElement("span",{className:"delete",onClick:e.deleteSubField.bind(e,a)},w.a.createElement(l.a,{type:"minus-circle"})))}):null))),w.a.createElement("div",{className:"ant-row ant-form-item"},w.a.createElement("div",{className:"ant-form-item-label"},w.a.createElement("label",null,"\u9ed8\u8ba4\u884c\u6570")),w.a.createElement("div",{className:"ant-form-item-control has-success"},w.a.createElement("span",{className:"ant-input-wrapper"},w.a.createElement("input",{className:"ant-input",value:this.state.defaultRows,onChange:function(t){return e.setControlProp("defaultRows",t.target.value)}})))),w.a.createElement("div",{className:"ant-row ant-form-item last-ant-form-item"},w.a.createElement("div",{className:"ant-form-item-control has-success"},w.a.createElement("label",{className:"ant-checkbox-wrapper"},w.a.createElement("input",{type:"checkbox",className:"config-text-readonly",checked:this.state.readonly,onChange:function(t){return e.setControlProp("readonly",t.target.checked)}}),w.a.createElement("span",null,"\u53ea\u8bfb"))),w.a.createElement("div",{className:"ant-form-item-control has-success"},w.a.createElement("label",{className:"ant-checkbox-wrapper"},w.a.createElement("input",{type:"checkbox",className:"config-text-hidden",checked:this.state.hidden,onChange:function(t){return e.setControlProp("hidden",t.target.checked)}}),w.a.createElement("span",null,"\u9690\u85cf"))),null))}},{key:"componentDidMount",value:function(){this.makeListSortable()}},{key:"componentDidUpdate",value:function(e,t){}},{key:"makeListSortable",value:function(){var e=this;k()("#sortable").sortable({axis:"y",stop:function(t,a){var l=e.state.subFields,n=[];k()("#sortable li").each(function(){n.push(l[k()(this).attr("fieldIndex")])}),e.setState({subFields:null}),l=n,e.setState({subFields:l,ischanged:!0})}}),k()("#sortable").disableSelection()}}]),t}(b.Component));t.default=S}}]);
//# sourceMappingURL=25.e0f46709.chunk.js.map