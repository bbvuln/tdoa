!function(t){var e=function(){};e.prototype.checkIsTouch=function(){return"ontouchstart"in t||navigator.maxTouchPoints},e.prototype.hackRequestAnimationFrame=function(arguments){if(t.requestAnimationFrame=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame,!t.requestAnimationFrame){var e=0;t.requestAnimationFrame=function(t){var i=(new Date).getTime(),n=Math.max(16-i-e,0),s=setTimeout(t,n);return e=i+n,s}}},e.prototype.hackTransform=function(){var t=document.documentElement;this.transformProperty="string"==typeof t.style.transform?"transform":"WebkitTransform"},e.prototype.hackEventListener=function(){document.addEventListener&&(this.eventListener=!0)},e.prototype.hackStyle=function(e){return t.getComputedStyle?t.getComputedStyle(e):e.currentStyle};var i=function(t,e){this.options=e||{},this.options.elemString=t,this.init()},n=i.prototype=new e;n.init=function(){this.setTargetDom(),this.hackEventListener(),this.eventListener||(this.options.backToPosition=!0),this.checkIsTouch()?this.elem.addEventListener("touchstart",this):this.eventListener?this.elem.addEventListener("mousedown",this):(this.bindAttach(),this.elem.attachEvent("onmousedown",this.b_mousedown)),this.options.cursorCancel||(this.elem.style.cursor="move")},n.setTargetDom=function(){this.elem=this.getDom(this.options.elemString),this.parentMove=this.getDom(this.options.parentMove),this.targetDom=this.parentMove||this.elem},n.getDom=function(t){return"string"==typeof t?document.querySelector(t):t},n.bindAttach=function(){for(var e=this,i=["mousedown","mousemove","mouseup"],n=0,s=i.length;n<s;n++)this["b_"+i[n]]=function(n){return function(){e.event=t.event,e[i[n]]()}}(n)},n.dragDown=function(t){this.enable=!0,this.hackTransform(),this.addClassName(),this.setIndex(),this.style=this.hackStyle(this.targetDom),this.targetPosition=this.getPosition(this.style),this.startPoint=this.getCoordinate(),this.movePoint={x:0,y:0},this.setPositionProperty(),this.bindCallBackEvent(),this.render()},n.addClassName=function(){this.options.addClassName&&(this.elem.className+=" "+this.options.addClassName)},n.setIndex=function(){},n.getPosition=function(t){var e={};return e.x="auto"==t.left?0:parseInt(t.left,10),e.y="auto"==t.top?0:parseInt(t.top,10),this.options.backToPosition?e:e=this.addTransform(e)},n.addTransform=function(t){var e=this.style[this.transformProperty];if(!e||"-1"==e.indexOf("matrix"))return t;var i="-1"==e.indexOf("matrix3d")?4:12,n=e.split(",");return this.translateX=parseInt(n[i],10),this.translateY=parseInt(n[i+1],10),t.x+=this.translateX,t.y+=this.translateY,t},n.getCoordinate=function(){return this.eventListener?{x:this.event.pageX||this.event.touches&&this.event.touches[0].pageX||0,y:this.event.pageY||this.event.touches&&this.event.touches[0].pageY||0}:{x:this.event.clientX+document.documentElement.scrollLeft,y:this.event.clientY+document.documentElement.scrollTop}},n.setPositionProperty=function(){({fix:!0,absolute:!0,relative:!0})[this.style.position]||(this.targetDom.style.position="relative"),this.targetDom.style.cssText+=";left:"+this.targetPosition.x+"px;top:"+this.targetPosition.y+"px;"},n.bindCallBackEvent=function(){var t=this.event.type,e={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend"]},i=e[t];this.handles=i,this.bindEvent(!0)},n.bindEvent=function(e){var i=this,n=this.handles;if(this.eventListener){var s=e?"addEventListener":"removeEventListener";n.forEach(function(e){t[s](e,i)})}else{var s=e?"attachEvent":"detachEvent";document[s]("onmousemove",this.b_mousemove),document[s]("onmouseup",this.b_mouseup)}},n.render=function(){var t=this;this.hackRequestAnimationFrame(),this._render=function(){t.enable&&(t.setTransform(),requestAnimationFrame(t._render))},requestAnimationFrame(this._render)},n.setTransform=function(){if(this.options.backToPosition){var t="left:"+(this.movePoint.x+this.targetPosition.x)+"px;top:"+(this.movePoint.y+this.targetPosition.y)+"px;";this.targetDom.style.cssText+=";"+t}else this.targetDom.style[this.transformProperty]="translate3d("+this.movePoint.x+"px,"+this.movePoint.y+"px,0)"},n.dragMove=function(){var t=this.getCoordinate(),e={x:t.x-this.startPoint.x,y:t.y-this.startPoint.y};e=this.setGrid(e),this.movePoint.x="y"==this.options.axis?0:e.x,this.movePoint.y="x"==this.options.axis?0:e.y},n.setGrid=function(t){if(!this.options.grid)return t;var e=this.options.grid,i={};return i.x=e.x?Math.round(t.x/e.x)*e.x:t.x,i.y=e.y?Math.round(t.y/e.y)*e.y:t.y,i},n.dragUp=function(){this.enable=!1,this.removeClassName(),this.bindEvent(!1),this.resetIndex(),this.options.backToPosition||this.resetPosition()},n.removeClassName=function(){if(this.options.addClassName){var t=new RegExp("(?:^|\\s)"+this.options.addClassName+"(?:\\s|$)","g");this.elem.className=this.elem.className.replace(t,"")}},n.resetIndex=function(){},n.resetPosition=function(){this.endPoint={x:this.movePoint.x+this.targetPosition.x,y:this.movePoint.y+this.targetPosition.y},this.targetDom.style.cssText+=";left:"+this.endPoint.x+"px;top:"+this.endPoint.y+"px;transform:translate3d(0,0,0)"},n.touchstart=function(t){this.dragDown(t)},n.mousedown=function(){this.dragDown()},n.mousemove=function(){this.dragMove()},n.touchmove=function(){this.dragMove()},n.mouseup=function(){this.dragUp()},n.touchend=function(){this.dragUp()},n.handleEvent=function(t){this.event=t;var e=this.event.type;e&&this[e]()},t.Draggable=i}(window);