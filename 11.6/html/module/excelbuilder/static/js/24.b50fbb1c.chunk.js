(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{641:function(e,t,a){},665:function(e,t,a){"use strict";a.r(t);a(113);var l=a(8),n=(a(201),a(60)),s=(a(45),a(9)),r=(a(84),a(22)),i=(a(200),a(21)),o=a(98),c=a(12),m=a(23),u=a(24),d=a(32),p=a(30),h=a(31),f=a(66),v=a(0),b=a.n(v),w=a(99),g=(a(629),a(627),a(86),a(48)),y=a(279),E=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).owner=a.props.owner,a.state={visible:!0},a.excelRef=b.a.createRef(),a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"handleOk",value:function(){for(var e=this,t=this.excelRef.current.excel,a=t.getSettings(),l=a.maxCols,n=a.maxRows;n>0&&t.isEmptyRow(n-1);)--n;for(;l>0&&t.isEmptyCol(l-1);)--l;var s=[];t.getPlugin("mergeCells").mergedCellsCollection.mergedCells.map(function(e){e.removed||s.push({row:e.row,col:e.col,rowspan:e.rowspan,colspan:e.colspan})});var r={},i=1;t.updateSettings({viewportRowRenderingOffset:n,viewportColumnRenderingOffset:l,mergeCells:s});for(var o=0;o<l;o++)for(var c=[],m=0,u=0;u<n;u++){var d=t.getCell(u,o),p=t.getCoords(d),h=t.getDataAtCell(p.row,p.col);if(null===h&&(h=""),u===p.row&&""!==h){m++;var f=t.getCellMeta(p.row,p.col);c.push({name:h,style:f.def&&f.def.styleName?f.def.styleName:{}})}""!==h&&p.col===o&&u===n-1&&(r[h]={columns:c,width:t.getColWidth(o)},i<m&&(i=m))}this.handleCancel(),window.setTimeout(function(){return e.owner.setSubFieldLayout(r,i)},0)}},{key:"handleCancel",value:function(){var e=this;window.setTimeout(function(){return e.owner.setState({listHeaderPropsShowFlag:!1})},0)}},{key:"render",value:function(){return b.a.createElement("div",null,b.a.createElement(g.a,{title:"\u8bbe\u8ba1\u5217\u8868\u5934",visible:this.state.visible,onOk:this.handleOk.bind(this),onCancel:this.handleCancel.bind(this),footer:[b.a.createElement(s.a,{key:"back",type:"ghost",size:"large",onClick:this.handleCancel.bind(this)},"\u53d6 \u6d88"),b.a.createElement(s.a,{key:"submit",type:"primary",size:"large",onClick:this.handleOk.bind(this)},"\u63d0 \u4ea4")],width:"915px",style:{top:"20px"},maskClosable:!1},b.a.createElement("div",{style:{height:"400px",overflow:"hidden"}},b.a.createElement(y.a,{ref:this.excelRef,single:!0,owner:this,items:this.props.items,sheets:[{index:"1",name:"\u5de5\u4f5c\u88681",cellSettings:{},cellMetas:{},charts:[],images:[],cellStyles:[],fieldMaps:[]}],activeKey:"1"}))))}},{key:"componentDidMount",value:function(){var e=this;window.setTimeout(function(){var t=e.props,a=t.level,l=t.subFields,n=e.excelRef.current.excel;if(n.updateSettings({maxCols:100}),l){var s=[],r=[],i=[];l.map(function(e,t){e.layout||(e.layout={columns:[]},e.layout.columns.push({name:e.title})),e.layout&&(e.layout.width&&s.push(e.layout.width),e.layout.columns.map(function(a,l){if(i.push([l,t,l===e.layout.columns.length-1?e.title:a.name]),a.style){var s=n.getCellMeta(l,t);s.def||(s.def={}),s.def.styleName=a.style,n.setCellMetaObject(l,t,s)}}))}),i.length>0&&n.setDataAtCell(i),s.length>0&&n.updateSettings({colWidths:s});for(var o=0;o<a;o++){for(var c=0,m="",u=0;u<l.length;){var d=n.getDataAtCell(o,u);null===d&&(d=""),""!==m&&m!==d&&(r.push({row:o,col:c,rowspan:1,colspan:u-c}),m=""),""===m&&(m=d,c=u),u++}""!==m&&r.push({row:o,col:c,rowspan:1,colspan:u-c})}for(var p=0;p<l.length;p++)for(var h=a-1;h>=0;h--){var f=n.getDataAtCell(h,p);if(null===f&&(f=""),""!==f){h<a-1&&r.push({row:h,col:p,rowspan:a-h,colspan:1});break}}r.length>0&&n.updateSettings({mergeCells:r})}},50)}}]),t}(v.Component),k=(a(641),a(4)),C=a.n(k),S=(a(643),function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).owner=a.props.owner,a.state={ischanged:!1,exprShowFlag:!1,outLinkShowFlag:!1,listHeaderPropsShowFlag:!1,name:"",title:"\u5217\u8868",desc:"",defaultType:"custom",defaultValue:"",required:!1,noDup:!1,readonly:!1,hidden:!1,asTitle:!1,isSearch:!1,link:"",type:"list",subFields:[],defaultRows:1,headLevel:1,autoSize:!1,treeNode:"",hideSeqNumber:!1,defaultPageSize:10},a.state=Object(c.a)({},a.state,a.props.def),a.owner.comfirmControlProp=a.comfirmControlProp.bind(Object(f.a)(Object(f.a)(a))),a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"comfirmControlProp",value:function(){if(this.state.ischanged){this.setState({ischanged:!1});var e=Object(c.a)({},this.state);delete e.ischanged,delete e.exprShowFlag,delete e.outLinkShowFlag,delete e.listHeaderPropsShowFlag,this.owner.sysCurCellMeta(e)}}},{key:"setControlProp",value:function(e,t){var a;"title"===e?this.setState((a={},Object(o.a)(a,e,t),Object(o.a)(a,"name",t),a)):this.setState(Object(o.a)({},e,t));this.setState({ischanged:!0})}},{key:"addSubField",value:function(e){var t=this,a=this.state.subFields,l=w.a.filter(function(t){return t.name===e.key});a.push({title:l[0].label,type:e.key}),this.setState({subFields:a}),window.setTimeout(function(){var e=Object(c.a)({},t.state);delete e.ischanged,delete e.exprShowFlag,delete e.outLinkShowFlag,delete e.listHeaderPropsShowFlag,t.owner.sysCurCellMeta(e)},0)}},{key:"setSubField",value:function(e,t){this.owner.setState({curSubField:e,curSubFieldIndex:t})}},{key:"deleteSubField",value:function(e){var t=this;if(window.confirm("\u786e\u5b9a\u8981\u5220\u9664\u8be5\u5b57\u6bb5\u5417\uff1f")){var a=this.state.subFields;a&&(a=a.filter(function(t,a){return e!==a}),this.setState({subFields:a}),window.setTimeout(function(){var e=Object(c.a)({},t.state);delete e.ischanged,delete e.exprShowFlag,delete e.outLinkShowFlag,delete e.listHeaderPropsShowFlag,t.owner.sysCurCellMeta(e)},0))}}},{key:"setSubFieldLayout",value:function(e,t){var a=this,l=this.state.subFields;l&&l.map(function(t){e[t.title]&&(t.layout=e[t.title],t.layout.columns[t.layout.columns.length-1].name=t.alias&&""!==t.alias?t.alias:t.title)}),this.setState({subFields:l,headLevel:t}),window.setTimeout(function(){var e=Object(c.a)({},a.state);delete e.ischanged,delete e.exprShowFlag,delete e.outLinkShowFlag,delete e.listHeaderPropsShowFlag,a.owner.sysCurCellMeta(e)},0)}},{key:"render",value:function(){var e=this,t=w.b.filter(function(t){return t.name===e.state.type}),a=w.a.filter(function(t){return t.name===e.state.type}),o=Object.keys(this.props.columnsOfForm).map(function(t){return e.props.columnsOfForm[t]}),c=(this.props.parent_list,b.a.createElement(i.a,{onClick:this.addSubField.bind(this)},w.a.map(function(e){return"autoNumber"!=e.name&&"list"!=e.name&&"signature"!=e.name&&b.a.createElement(i.a.Item,{key:e.name},e.label)})));this.state.defaultValue,this.props.formId;return b.a.createElement("div",{className:"config-panel list-panel "},b.a.createElement("div",{className:"ant-row ant-form-item"},b.a.createElement("div",{className:"ant-form-item-label"},b.a.createElement("label",null,"\u540d\u79f0")),b.a.createElement("div",{className:"ant-form-item-control has-success"},b.a.createElement("span",{className:"ant-input-wrapper"},b.a.createElement("input",{type:"text",placeholder:"\u8bf7\u8f93\u5165\u63a7\u4ef6\u540d\u79f0",className:"config-text-len ant-input",value:this.state.title,onChange:function(t){return e.setControlProp("title",t.target.value)}})))),b.a.createElement("div",{className:"ant-row ant-form-item"},b.a.createElement("div",{className:"ant-form-item-label"},b.a.createElement("label",null,"\u63a7\u4ef6\u7c7b\u578b"),b.a.createElement("span",{className:"ant-input-wrapper config-typename"},t&&t.length>0?b.a.createElement(r.a,{value:[this.state.type],onChange:function(t){return e.setControlProp("type",t)},size:"small",style:{width:"120px"}},w.b.map(function(e){return b.a.createElement(r.a.Option,{value:e.name,key:e.name},e.label)})):b.a.createElement("span",{className:"ant-input-wrapper config-typename"},a[0].label)))),b.a.createElement("div",{className:"ant-row ant-form-item"},b.a.createElement("div",{className:"ant-form-item-label"},b.a.createElement("label",null,"\u63cf\u8ff0")),b.a.createElement("div",{className:"ant-form-item-control has-success"},b.a.createElement("span",{className:"ant-input-wrapper"},b.a.createElement("textarea",{type:"textarea",placeholder:"\u8bf7\u8f93\u5165\u63a7\u4ef6\u63cf\u8ff0",className:"config-text-desc ant-input",value:this.state.desc,onChange:function(t){return e.setControlProp("desc",t.target.value)}})))),b.a.createElement("div",{className:"ant-row ant-form-item"},b.a.createElement("div",{className:"ant-form-item-label"},b.a.createElement("label",null,"\u5b57\u6bb5")),b.a.createElement("div",{className:"ant-form-item-control has-success"},b.a.createElement(n.a,{overlay:c},b.a.createElement(s.a,null,"\u6dfb\u52a0\u5b57\u6bb5")),b.a.createElement(s.a,{onClick:function(){return e.setState({listHeaderPropsShowFlag:!0})}},"\u8bbe\u8ba1\u8868\u5934"),this.state.listHeaderPropsShowFlag?b.a.createElement(E,{owner:this,level:this.state.headLevel,subFields:this.state.subFields,items:this.props.columnsOfForm}):null,b.a.createElement("ul",{className:"sub-fields",id:"sortable"},this.state.subFields?this.state.subFields.map(function(t,a){return b.a.createElement("li",{key:a,fieldIndex:a},b.a.createElement("p",{onClick:e.setSubField.bind(e,t,a)},t.title),b.a.createElement("span",{className:"delete",onClick:e.deleteSubField.bind(e,a)},b.a.createElement(l.a,{type:"minus-circle"})))}):null))),b.a.createElement("div",{className:"ant-row ant-form-item"},b.a.createElement("div",{className:"ant-form-item-label"},b.a.createElement("label",null,"\u9ed8\u8ba4\u884c\u6570")),b.a.createElement("div",{className:"ant-form-item-control has-success"},b.a.createElement("span",{className:"ant-input-wrapper"},b.a.createElement("input",{className:"ant-input",value:this.state.defaultRows,onChange:function(t){return e.setControlProp("defaultRows",t.target.value)}})))),b.a.createElement("div",{className:"ant-row ant-form-item"},b.a.createElement("div",{className:"ant-form-item-label"},b.a.createElement("label",null,"\u9ed8\u8ba4\u5206\u9875\u884c\u6570")),b.a.createElement("div",{className:"ant-form-item-control has-success"},b.a.createElement("span",{className:"ant-input-wrapper"},b.a.createElement(r.a,{size:"small",value:[this.state.defaultPageSize],placeholder:"\u8bf7\u9009\u62e9",onChange:function(t){return e.setControlProp("defaultPageSize",t)},style:{width:120}},b.a.createElement(r.a.Option,{value:"1",key:1},"1\u6761/\u9875"),b.a.createElement(r.a.Option,{value:"2",key:2},"2\u6761/\u9875"),b.a.createElement(r.a.Option,{value:"3",key:3},"3\u6761/\u9875"),b.a.createElement(r.a.Option,{value:"4",key:4},"4\u6761/\u9875"),b.a.createElement(r.a.Option,{value:"5",key:5},"5\u6761/\u9875"),b.a.createElement(r.a.Option,{value:"10",key:10},"10\u6761/\u9875"),b.a.createElement(r.a.Option,{value:"15",key:15},"15\u6761/\u9875"),b.a.createElement(r.a.Option,{value:"20",key:20},"20\u6761/\u9875"),b.a.createElement(r.a.Option,{value:"50",key:50},"50\u6761/\u9875"),b.a.createElement(r.a.Option,{value:"100",key:100},"100\u6761/\u9875"))))),b.a.createElement("div",{className:"ant-row ant-form-item"},b.a.createElement("div",{className:"ant-form-item-label"},b.a.createElement("label",null,"\u6811\u8282\u70b9")),b.a.createElement("div",{className:"ant-form-item-control has-success"},b.a.createElement("span",{className:"ant-input-wrapper"},b.a.createElement(r.a,{size:"small",value:[this.state.treeNode],placeholder:"\u8bf7\u9009\u62e9",style:{width:150},onChange:function(t){return e.setControlProp("treeNode",t)}},b.a.createElement(r.a.Option,{value:""},""),o.map(function(t){return 0===t.name.indexOf(e.state.title+".")&&"text"===t.type&&b.a.createElement(r.a.Option,{value:t.id},t.name)}))))),b.a.createElement("div",{className:"ant-row ant-form-item last-ant-form-item"},b.a.createElement("div",{className:"ant-form-item-control has-success"},b.a.createElement("label",{className:"ant-checkbox-wrapper"},b.a.createElement("input",{type:"checkbox",className:"config-text-readonly",checked:this.state.readonly,onChange:function(t){return e.setControlProp("readonly",t.target.checked)}}),b.a.createElement("span",null,"\u53ea\u8bfb"))),b.a.createElement("div",{className:"ant-form-item-control has-success"},b.a.createElement("label",{className:"ant-checkbox-wrapper"},b.a.createElement("input",{type:"checkbox",className:"config-text-hidden",checked:this.state.hidden,onChange:function(t){return e.setControlProp("hidden",t.target.checked)}}),b.a.createElement("span",null,"\u9690\u85cf"))),b.a.createElement("div",{className:"ant-form-item-control has-success"},b.a.createElement("label",{className:"ant-checkbox-wrapper"},b.a.createElement("input",{type:"checkbox",className:"config-text-hidden",checked:this.state.hideSeqNumber,onChange:function(t){return e.setControlProp("hideSeqNumber",t.target.checked)}}),b.a.createElement("span",null,"\u9690\u85cf\u5e8f\u53f7"))),null))}},{key:"componentDidMount",value:function(){this.makeListSortable()}},{key:"componentDidUpdate",value:function(e,t){}},{key:"makeListSortable",value:function(){var e=this;C()("#sortable").sortable({axis:"y",stop:function(t,a){var l=e.state.subFields,n=[];C()("#sortable li").each(function(){n.push(l[C()(this).attr("fieldIndex")])}),e.setState({subFields:null}),l=n,e.setState({subFields:l,ischanged:!0})}}),C()("#sortable").disableSelection()}}]),t}(v.Component));t.default=S}}]);
//# sourceMappingURL=24.b50fbb1c.chunk.js.map