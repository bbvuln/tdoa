(function(a){var e=new Date();var f=e.getMonth();var g=e.getYear()+1900;a.fn.calendarWidget=function(h){this.data("calendarWidget",new b(this,h));return this};a.fn.calendarWidget.defaultOptions={month:f,year:g,maxYear:parseInt(g+2),minYear:parseInt(g-2),clickCallback:a.noop,initCallback:a.noop,monthNames:"1 2 3 4 5 6 7 8 9 10 11 12".split(" "),dayNames:["周日","周一","周二","周三","周四","周五","周六"],prev_handle:'<em class="prev_month"><b></b></em>',next_handle:'<em class="next_month"><b></b></em>'};function b(o,x){this.el=o;var t=this;var w=this.options=a.extend(a.fn.calendarWidget.defaultOptions,x);var v=w.monthNames;var l=w.dayNames;var u=this.month=r=parseInt(w.month);var C=this.year=parseInt(w.year);var s=0;var B="";B+=('<h3 id="current-month" class="calendar-title"><i class="year">'+C+'</i>年<i class="month">'+v[u]+"</i>月</h3>");B+=('<table class="calendar-month " id="calendar-month'+r+' " cellspacing="0">');B+="<tr>";for(d=0;d<7;d++){B+='<th class="weekday">'+l[d]+"</th>"}B+="</tr>";var n=c(u,C);var q=new Date(C,u,1);var p=q.getDay();var y=c(u,C);var q=new Date(C,u,1);var p=q.getDay();var z=u==0?11:u-1;var A=z==11?C-1:C;var y=c(z,A);p=(p==0&&q)?7:p;var r=0;for(j=0;j<42;j++){if((j<p)){B+=('<td class="other-month"><span class="day">'+(y-p+j+1)+"</span></td>")}else{if((j>=p+c(u,C))){r=r+1;B+=('<td class="other-month"><span class="day">'+r+"</span></td>")}else{B+=('<td data-day="'+(j-p+1)+'" class="current-month day'+(j-p+1)+'"><span class="day">'+(j-p+1)+"</span></td>")}}if(j%7==6){B+=("</tr>")}}B+=("</table>");var h=a(B);o.html(h);if(w.prev_handle&&w.next_handle){var k=a("h3.calendar-title",o);if(w.minYear&&!(w.minYear==C&&u==0)){a(w.prev_handle).prependTo(k).click(a.proxy(this.prev_month,this))}if(w.maxYear&&!(w.maxYear==C&&u==11)){a(w.next_handle).appendTo(k).click(a.proxy(this.next_month,this))}}o.delegate("td.current-month","click.calendarWidget",function(i){if(false===w.clickCallback.call(this,t,i)){return false}a("td.current-month",o).removeClass("active");a(this).addClass("active")});w.initCallback.apply(this,arguments)}b.prototype={constructor:b,prev_month:function(){var i=this.options;var h=this.month;if(h==0){this.year--;h=11}else{h--}this.month=h;i.month=h;i.year=this.year;this.el.data("calendarWidget",new this.constructor(this.el,i))},next_month:function(){var i=this.options;var h=this.month;if(h==11){this.year++;h=0}else{h++}this.month=h;i.month=h;i.year=this.year;this.el.data("calendarWidget",new this.constructor(this.el,i))},today:function(){var i=this.options;if(i.month!==f||i.year!==g){i.month=f;i.year=g;this.el.data("calendarWidget",new this.constructor(this.el,i))}var h=".day"+e.getDate();a(h,this.el).click()}};function c(i,k){var h=[31,28,31,30,31,30,31,31,30,31,30,31];if((i==1)&&(k%4==0)&&((k%100!=0)||(k%400==0))){return 29}else{return h[i]}}})(jQuery);