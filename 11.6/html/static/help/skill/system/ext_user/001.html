<h4 style="font-family:'微软雅黑'"><span>OA系统内置接口设置及相关应用有哪些？</span></h4>
<hr>
<p style="font-size:1.1em;line-height:22px;">
<b>系统接口设置的目的</b><br/>
为了可以让外部系统跟OA进行数据交换，OA增加了系统接口设置。通过设置用户帐号权限，来控制外部系统对OA数据的访问，即可达到数据交换的目的，又可以保证系统和数据的安全性。</b><br/>
<b>如何使用:</b><br/>
首先，在系统接口设置模块添加用户，并设置该用户的模块权限；然后，按照系统规范的数据格式，访问系统提供的接口地址，并提交固定格式的数据。<br/>

现有接口类型<br/>
事务提醒、工作流<br/>

[事务提醒]<br/>
接口形式：<br/>
以表单(form)的方式提交，Get或Post均可<br/>

<b>接口地址：</b><br/>
<font color="0000FF"><u>http://oa</u></font>/interface/sms.php 其中蓝色带下划线部分为实际的OA地址<br><br>

<b>参数说明：</b><br/>
USER_ID     权限验证用户名，字符串，由OA管理员在系统接口设置模块添加<br/>
PASSWORD    权限验证密码明文，字符串<br/>

FROM_ID     发送人用户名，字符串，如“admin”<br/>
TO_ID       接收人用户名，字符串，如果群发用英文逗号隔开，如“admin,lxq,gb,whl,”<br/>
SMS_TYPE    事务提醒类型，字符类型<br/>
CONTENT     短信内容，文本格式<br/>
SEND_TIME   发送时间，文本格式，如“2010-10-01 10:20:09”<br/>

<b>返回值：</b><br/>
格式：代码#|#代码描述，“#|#”为分隔符<br/>

<b>代码描述：</b><br/>
100   发送成功<br/>
201   用户名或密码为空<br/>
202   用户名不存在，#|#后边的部分为不存在的USER_ID<br/>
203   密码错误<br/>
204   帐号已停用<br/>
205   服务未授权，您使用的帐号没有权限使用该接口发送短信<br/>
301   FROM_ID为空<br/>
302   TO_ID为空<br/>
303   CONTENT为空<br/>
304   SEND_TIME无效<br/>
305   发送人不存在，#|#后边的部分为不存在的FROM_ID<br/>
306   部分接收人不存在，#|#后边的部分为不存在的TO_ID<br/>
307   短信类型无效，#|#后边的部分为无效的SMS_TYPE<br/>

<b>注意：</b><br/>
SMS_REMIND代码可在“系统代码设置”模块的“提醒类型”中查看，为空则使用“0”<br/>
SEND_TIME为空则使用OA服务器当前系统时间<br/>

<b>技巧：</b>
为了区分不同的系统发送的短信，可在“系统接口设置”模块添加用户时，在“内容后缀”栏目输入内容加以区别，如“该信息由XXX系统发送”等。<br/>


[工作流]<br/>
<b>接口形式：</b><br/>
以表单(form)的方式提交，Get或Post均可<br/>

<b>接口地址：</b><br/>
<font color="0000FF"><u>http://oa</u></font>/interface/workflow.php 其中蓝色带下划线部分为实际的OA地址<br><br>

<b>参数说明：</b><br/>
USER_ID     权限验证用户名，字符串，由OA管理员在“系统接口设置”模块添加<br/>
PASSWORD    权限验证密码明文，字符串<br/>

BEGIN_USER   可选,工作发起人登录ID，字符串，如“admin”<br/>
DEPT_ID     可选,部门内部ID号，数字<br/>
FLOW_ID     可选,流程内部ID，数字<br/>
START_TIME     可选,开始时间,格式为:2013-11-23 10:40:23<br/>
END_TIME    可选,截至时间,格式为:2013-11-23 10:40:23”<br/>

<b>返回值：</b><br/>
正常返回UTF-8编码的XML数据，包括流水号、工作名称文号、发起人、发起时间、当前主办人、当前步骤名称<br/>

错误格式：代码#|#代码描述，“#|#”为分隔符<br/>
<b>代码描述：</b><br/>
201   用户名或密码为空<br/>
202   用户名不存在，#|#后边的部分为不存在的USER_ID<br/>
203   密码错误<br/>
204   帐号已停用<br/>
205   服务未授权，您使用的帐号没有权限使用该接口发送短信<br/>
301   START_TIME无效<br/>
302   END_TIME无效
</p>



